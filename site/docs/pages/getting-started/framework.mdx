# Framework Overview

L8B Framework is a custom build system designed specifically for game development. It provides a complete development and build pipeline without relying on external bundlers like Vite.

## Architecture

The framework consists of several packages working together:

```
@l8b/cli
├── @l8b/framework-server    # Development server with HMR
│   ├── @l8b/compiler        # LootiScript compilation
│   ├── @l8b/framework-watcher  # File watching
│   ├── @l8b/framework-html     # HTML generation
│   └── @l8b/framework-config   # Configuration
├── @l8b/framework-bundler  # Production bundler
│   ├── @l8b/compiler
│   └── @l8b/framework-config
└── @l8b/framework-shared    # Shared utilities
```

## Key Features

### Development Server

- **Hot Module Replacement (HMR)** - Instant code reload without page refresh
- **Live Asset Reloading** - Sprite, map, and sound changes reflect immediately
- **Error Overlay** - Compilation errors displayed in browser
- **WebSocket Communication** - Real-time updates between server and client

### Production Build

- **Bytecode Compilation** - LootiScript compiled to optimized bytecode
- **Asset Processing** - Automatic sprite, map, and sound optimization
- **Runtime Bundling** - Single-file runtime bundle for fast loading
- **Minification** - Optional code minification for production

### Custom Build System

The framework does **not** use Vite or other generic bundlers because:

1. **Game-Specific Requirements** - Optimized for game asset loading patterns
2. **Direct Control** - Full control over compilation and bundling pipeline
3. **LootiScript Integration** - Native support for `.loot` file compilation
4. **Performance** - Optimized for game engine runtime requirements

## Development Workflow

### 1. Start Development Server

```bash
l8b dev
```

This will:
- Start HTTP server on port 3000 (default)
- Watch for file changes in `src/` and `public/`
- Compile `.loot` files on-the-fly
- Provide HMR via WebSocket

### 2. Write Your Game

All `.loot` files in `src/` are automatically discovered and compiled:

```
src/
├── main.loot          # Main game code
├── scenes/
│   ├── menu.loot
│   └── game.loot
└── utils/
    └── helpers.loot
```

### 3. Build for Production

```bash
l8b build
```

This will:
- Compile all `.loot` files to bytecode
- Bundle runtime and compiled sources
- Copy assets from `public/` to `.l8b/`
- Generate production HTML

## Build Output

### Development

During development, sources are loaded directly:

```html
<!-- Development mode -->
<script type="module">
  // Sources loaded from src/ directory
  // Compiled on-the-fly
</script>
```

### Production

Production build generates optimized output:

```
.l8b/
├── index.html      # Entry HTML
├── runtime.js      # Bundled runtime
├── modules/        # Compiled bytecode
│   ├── main.l8b
│   └── scenes/
│       ├── menu.l8b
│       └── game.l8b
└── assets/         # Copied assets
    ├── sprites/
    ├── maps/
    ├── sounds/
    └── music/
```

## Configuration

Framework behavior is controlled via `l8b.config.json`:

```json
{
  "name": "my-game",
  "srcDir": "src",
  "publicDir": "public",
  "outDir": ".l8b",
  "dev": {
    "port": 3000,
    "host": "localhost"
  }
}
```

## Resource Discovery

The framework automatically discovers resources:

- **Sources**: All `.loot` files in `src/` directory
- **Sprites**: Images in `public/sprites/`
- **Maps**: JSON files in `public/maps/`
- **Sounds**: Audio files in `public/sounds/`
- **Music**: Audio files in `public/music/`
- **Fonts**: Font files in `public/fonts/`

## HMR System

The Hot Module Replacement system works by:

1. **File Watcher** detects changes in `src/` or `public/`
2. **Compiler** recompiles changed `.loot` files
3. **HMR Server** sends update message via WebSocket
4. **Client** receives update and reloads changed modules
5. **Runtime** updates sources without full page reload

This provides instant feedback during development.

## Comparison with Other Build Tools

| Feature | L8B Framework | Vite | Webpack |
|---------|---------------|------|---------|
| Game-focused | ✅ | ❌ | ❌ |
| LootiScript support | ✅ Native | ❌ | ❌ |
| HMR for game assets | ✅ | ⚠️ Limited | ⚠️ Limited |
| Custom compilation | ✅ | ⚠️ Plugin | ⚠️ Plugin |
| Runtime optimization | ✅ | ❌ | ❌ |

## Next Steps

- Learn about [CLI Commands](/cli) for development and build
- Explore [Configuration](/configuration/config) options
- See [Quick Start](/getting-started/quick-start) for getting started

