{"version":3,"sources":["../src/server.ts","../src/embedded/language-modes.ts","../src/embedded/mode-manager.ts","../src/embedded/json-mode.ts","../src/api-definitions/core.ts","../src/api-definitions/screen.ts","../src/api-definitions/audio.ts","../src/api-definitions/input.ts","../src/api-definitions/system.ts","../src/api-definitions/scene.ts","../src/api-definitions/sprites.ts","../src/api-definitions/map.ts","../src/api-definitions/time.ts","../src/api-definitions/assets.ts","../src/api-definitions/palette.ts","../src/api-definitions/player.ts","../src/api-definitions/wallet.ts","../src/api-definitions/evm.ts","../src/api-definitions/actions.ts","../src/api-definitions/http.ts","../src/api-definitions/index.ts","../src/document-state.ts","../src/validation.ts","../src/utils.ts","../src/settings.ts","../src/handlers/completion.ts","../src/handlers/hover.ts","../src/handlers/signature-help.ts","../src/handlers/symbols.ts","../src/handlers/formatting.ts","../src/handlers/code-actions.ts","../src/handlers/definition.ts","../src/handlers/references.ts","../src/handlers/rename.ts","../src/handlers/semantic-tokens.ts"],"sourcesContent":["import {\n\tcreateConnection,\n\tTextDocuments,\n\tProposedFeatures,\n\tInitializeParams,\n\tDidChangeConfigurationNotification,\n\tTextDocumentSyncKind,\n\tInitializeResult,\n\tCodeActionKind,\n} from \"vscode-languageserver/node\";\nimport { TextDocument } from \"vscode-languageserver-textdocument\";\nimport { LanguageModes, DocumentRegionsCache } from \"./embedded/mode-manager\";\nimport { getJSONMode, createJSONLanguageService } from \"./embedded/json-mode\";\nimport { GLOBAL_API } from \"./api-definitions/index\";\nimport { updateDocumentState, deleteDocumentState } from \"./document-state\";\nimport { validateTextDocument } from \"./validation\";\nimport { setupCompletionHandlers } from \"./handlers/completion\";\nimport { setupHoverHandler } from \"./handlers/hover\";\nimport { setupSignatureHelpHandler } from \"./handlers/signature-help\";\nimport { setupSymbolHandlers } from \"./handlers/symbols\";\nimport { setupFormattingHandler } from \"./handlers/formatting\";\nimport { setupCodeActionsHandler } from \"./handlers/code-actions\";\nimport { setupDefinitionHandler } from \"./handlers/definition\";\nimport { setupReferencesHandler } from \"./handlers/references\";\nimport { setupRenameHandler } from \"./handlers/rename\";\nimport {\n\tsetupSemanticTokensHandler,\n\tTOKEN_TYPES,\n\tTOKEN_MODIFIERS,\n} from \"./handlers/semantic-tokens\";\nimport {\n\tclearDocumentSettings,\n\tsetGlobalSettings,\n\tsanitizeSettings,\n} from \"./settings\";\n\n// Create LSP connection with all proposed protocol features enabled\nconst connection = createConnection(ProposedFeatures.all);\n\n// Document manager tracks all open text documents and their state\nconst documents: TextDocuments<TextDocument> = new TextDocuments(TextDocument);\n\n// Initialize embedded language support system for JSON, etc.\nconst documentRegionsCache = new DocumentRegionsCache();\nconst languageModes = new LanguageModes(documentRegionsCache);\n\n// Register JSON language mode for embedded JSON validation and completion\nconst jsonLanguageService = createJSONLanguageService();\nlanguageModes.registerMode(\n\tgetJSONMode(jsonLanguageService, documentRegionsCache),\n);\n\nconst GLOBAL_API_REQUEST = \"lootiscript/globalApi\";\nconnection.onRequest(GLOBAL_API_REQUEST, () => GLOBAL_API);\n\nlet hasConfigurationCapability = false;\nlet hasWorkspaceFolderCapability = false;\n\nconnection.onInitialize((params: InitializeParams) => {\n\tconst capabilities = params.capabilities;\n\n\t// Check if client supports workspace/configuration requests\n\t// If not supported, fall back to global settings\n\thasConfigurationCapability = !!(\n\t\tcapabilities.workspace && !!capabilities.workspace.configuration\n\t);\n\thasWorkspaceFolderCapability = !!(\n\t\tcapabilities.workspace && !!capabilities.workspace.workspaceFolders\n\t);\n\n\tconst result: InitializeResult = {\n\t\tcapabilities: {\n\t\t\ttextDocumentSync: TextDocumentSyncKind.Incremental,\n\t\t\t// Declare all LSP features this server implements\n\t\t\tcompletionProvider: {\n\t\t\t\tresolveProvider: true,\n\t\t\t\ttriggerCharacters: [\".\"],\n\t\t\t},\n\t\t\tsignatureHelpProvider: {\n\t\t\t\ttriggerCharacters: [\"(\", \",\"],\n\t\t\t},\n\t\t\thoverProvider: true,\n\t\t\tdefinitionProvider: true,\n\t\t\tdocumentSymbolProvider: true,\n\t\t\tworkspaceSymbolProvider: true,\n\t\t\treferencesProvider: true,\n\t\t\tdocumentFormattingProvider: true,\n\t\t\trenameProvider: {\n\t\t\t\tprepareProvider: true,\n\t\t\t},\n\t\t\tcodeActionProvider: {\n\t\t\t\tcodeActionKinds: [CodeActionKind.QuickFix, CodeActionKind.Refactor],\n\t\t\t},\n\t\t\tsemanticTokensProvider: {\n\t\t\t\tlegend: {\n\t\t\t\t\ttokenTypes: TOKEN_TYPES,\n\t\t\t\t\ttokenModifiers: TOKEN_MODIFIERS,\n\t\t\t\t},\n\t\t\t\tfull: true,\n\t\t\t},\n\t\t},\n\t};\n\tif (hasWorkspaceFolderCapability) {\n\t\tresult.capabilities.workspace = {\n\t\t\tworkspaceFolders: {\n\t\t\t\tsupported: true,\n\t\t\t},\n\t\t};\n\t}\n\treturn result;\n});\n\nconnection.onInitialized(() => {\n\tif (hasConfigurationCapability) {\n\t\t// Subscribe to configuration change notifications from the client\n\t\tconnection.client.register(\n\t\t\tDidChangeConfigurationNotification.type,\n\t\t\tundefined,\n\t\t);\n\t}\n\tif (hasWorkspaceFolderCapability) {\n\t\tconnection.workspace.onDidChangeWorkspaceFolders((_event) => {\n\t\t\tconnection.console.log(\"Workspace folder change event received.\");\n\t\t});\n\t}\n});\n\nconnection.onDidChangeConfiguration(async (change) => {\n\tif (hasConfigurationCapability) {\n\t\tclearDocumentSettings();\n\t} else {\n\t\tsetGlobalSettings(sanitizeSettings(change.settings?.lootiscript));\n\t}\n\n\tfor (const doc of documents.all()) {\n\t\tawait validateTextDocument(\n\t\t\tdoc,\n\t\t\tconnection,\n\t\t\thasConfigurationCapability,\n\t\t\tlanguageModes,\n\t\t\tdocumentRegionsCache,\n\t\t);\n\t}\n});\n\n// Triggered when document content changes (typing, paste, etc.)\ndocuments.onDidChangeContent((change) => {\n\tupdateDocumentState(change.document, connection);\n\tvalidateTextDocument(\n\t\tchange.document,\n\t\tconnection,\n\t\thasConfigurationCapability,\n\t\tlanguageModes,\n\t\tdocumentRegionsCache,\n\t);\n});\n\ndocuments.onDidOpen((change) => {\n\tupdateDocumentState(change.document, connection);\n\tvalidateTextDocument(\n\t\tchange.document,\n\t\tconnection,\n\t\thasConfigurationCapability,\n\t\tlanguageModes,\n\t\tdocumentRegionsCache,\n\t);\n});\n\ndocuments.onDidClose((change) => {\n\tdeleteDocumentState(change.document.uri);\n\tconnection.sendDiagnostics({ uri: change.document.uri, diagnostics: [] });\n});\n\nconnection.onDidChangeWatchedFiles((_change) => {\n\t// React to file system changes for watched files (e.g., .loot files)\n\tconnection.console.log(\"We received an file change event\");\n});\n\n// Register all LSP feature handlers\n// Provides IDE features: autocomplete, hover tooltips, go-to-definition, etc.\nsetupCompletionHandlers(\n\tconnection,\n\tdocuments,\n\tlanguageModes,\n\thasConfigurationCapability,\n);\nsetupHoverHandler(connection, documents, languageModes);\nsetupSignatureHelpHandler(connection, documents, hasConfigurationCapability);\nsetupSymbolHandlers(connection);\nsetupFormattingHandler(connection, documents, hasConfigurationCapability);\nsetupCodeActionsHandler(connection, documents);\nsetupDefinitionHandler(connection, documents);\nsetupReferencesHandler(connection, documents);\nsetupRenameHandler(connection, documents);\nsetupSemanticTokensHandler(connection, documents);\n\n// Connect document manager to LSP connection\n// Handles document lifecycle events (open, change, close)\ndocuments.listen(connection);\n\n// Start the LSP server and begin processing client requests\nconnection.listen();\n","import { TextDocument, Position } from \"vscode-languageserver-textdocument\";\nimport {\n\tCompletionList,\n\tCompletionItem,\n\tHover,\n\tDiagnostic,\n\tDocumentSymbol,\n} from \"vscode-languageserver/node\";\n\n/**\n * Language mode interface for handling embedded languages\n */\nexport interface LanguageMode {\n\tgetId(): string;\n\tdoComplete?(\n\t\tdocument: TextDocument,\n\t\tposition: Position,\n\t):\n\t\t| CompletionList\n\t\t| CompletionItem[]\n\t\t| null\n\t\t| Promise<CompletionList | CompletionItem[] | null>;\n\tdoHover?(\n\t\tdocument: TextDocument,\n\t\tposition: Position,\n\t): Hover | null | Promise<Hover | null>;\n\tdoValidation?(document: TextDocument): Diagnostic[] | Promise<Diagnostic[]>;\n\tfindDocumentSymbols?(\n\t\tdocument: TextDocument,\n\t): DocumentSymbol[] | Promise<DocumentSymbol[]>;\n}\n\n/**\n * Language region represents an embedded language section in a document\n */\nexport interface LanguageRegion {\n\tlanguageId: string;\n\tstart: number;\n\tend: number;\n\tstartLine: number;\n\tstartCharacter: number;\n\tendLine: number;\n\tendCharacter: number;\n}\n\n/**\n * Document regions manager - tracks embedded language regions in a document\n */\nexport class DocumentRegions {\n\tprivate regions: LanguageRegion[] = [];\n\n\tconstructor(private document: TextDocument) {\n\t\tthis.scanRegions();\n\t}\n\n\t/**\n\t * Scan document for embedded language regions\n\t * Currently supports:\n\t * - JSON in `json` blocks: ```json ... ```\n\t * - JSON in JSON.parse() calls\n\t * - Template string interpolation\n\t */\n\tprivate scanRegions(): void {\n\t\tconst text = this.document.getText();\n\t\tconst lines = text.split(\"\\n\");\n\n\t\t// Scan for ```json code blocks\n\t\tlet inJsonBlock = false;\n\t\tlet jsonBlockStart = 0;\n\n\t\tfor (let i = 0; i < lines.length; i++) {\n\t\t\tconst line = lines[i];\n\t\t\tconst jsonBlockMatch = line.match(/^```(json|JSON)$/);\n\t\t\tconst jsonBlockEnd = line.match(/^```$/);\n\n\t\t\tif (jsonBlockMatch && !inJsonBlock) {\n\t\t\t\tinJsonBlock = true;\n\t\t\t\tjsonBlockStart = i;\n\t\t\t} else if (jsonBlockEnd && inJsonBlock) {\n\t\t\t\t// Calculate positions\n\t\t\t\tconst startOffset = this.document.offsetAt({\n\t\t\t\t\tline: jsonBlockStart,\n\t\t\t\t\tcharacter: 0,\n\t\t\t\t});\n\t\t\t\tconst endOffset = this.document.offsetAt({\n\t\t\t\t\tline: i,\n\t\t\t\t\tcharacter: 0,\n\t\t\t\t});\n\n\t\t\t\tthis.regions.push({\n\t\t\t\t\tlanguageId: \"json\",\n\t\t\t\t\tstart: startOffset,\n\t\t\t\t\tend: endOffset,\n\t\t\t\t\tstartLine: jsonBlockStart,\n\t\t\t\t\tstartCharacter: 0,\n\t\t\t\t\tendLine: i,\n\t\t\t\t\tendCharacter: 0,\n\t\t\t\t});\n\n\t\t\t\tinJsonBlock = false;\n\t\t\t}\n\t\t}\n\n\t\t// Scan for JSON.parse(\"...\") patterns\n\t\tconst jsonParseRegex =\n\t\t\t/JSON\\.parse\\s*\\(\\s*([\"'`])((?:\\\\.|(?!\\1).)*)\\1\\s*\\)/gs;\n\t\tlet match;\n\t\twhile ((match = jsonParseRegex.exec(text)) !== null) {\n\t\t\tconst startOffset = match.index + match[0].indexOf(match[2]);\n\t\t\tconst endOffset = startOffset + match[2].length;\n\n\t\t\tconst startPos = this.document.positionAt(startOffset);\n\t\t\tconst endPos = this.document.positionAt(endOffset);\n\n\t\t\tthis.regions.push({\n\t\t\t\tlanguageId: \"json\",\n\t\t\t\tstart: startOffset,\n\t\t\t\tend: endOffset,\n\t\t\t\tstartLine: startPos.line,\n\t\t\t\tstartCharacter: startPos.character,\n\t\t\t\tendLine: endPos.line,\n\t\t\t\tendCharacter: endPos.character,\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * Get the language mode at a given position\n\t */\n\tgetLanguageAtPosition(position: Position): string | null {\n\t\tconst offset = this.document.offsetAt(position);\n\n\t\tfor (const region of this.regions) {\n\t\t\tif (offset >= region.start && offset <= region.end) {\n\t\t\t\treturn region.languageId;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t/**\n\t * Get all regions for a specific language\n\t */\n\tgetRegionsForLanguage(languageId: string): LanguageRegion[] {\n\t\treturn this.regions.filter((r) => r.languageId === languageId);\n\t}\n\n\t/**\n\t * Get embedded document content for a specific language\n\t * Replaces all non-matching regions with whitespace\n\t */\n\tgetEmbeddedDocument(languageId: string): TextDocument {\n\t\tconst text = this.document.getText();\n\t\tconst languageRegions = this.getRegionsForLanguage(languageId);\n\n\t\t// If no regions for this language, return empty document\n\t\tif (languageRegions.length === 0) {\n\t\t\treturn TextDocument.create(\n\t\t\t\tthis.document.uri + \".\" + languageId,\n\t\t\t\tlanguageId,\n\t\t\t\tthis.document.version,\n\t\t\t\t\"\", // Empty content\n\t\t\t);\n\t\t}\n\n\t\t// Build virtual document with only the matching language content\n\t\tlet result = \"\";\n\t\tlet lastOffset = 0;\n\n\t\t// Sort regions by start position\n\t\tconst sortedRegions = [...languageRegions].sort(\n\t\t\t(a, b) => a.start - b.start,\n\t\t);\n\n\t\tfor (const region of sortedRegions) {\n\t\t\t// Add whitespace for content before this region\n\t\t\tif (region.start > lastOffset) {\n\t\t\t\tresult += \" \".repeat(region.start - lastOffset);\n\t\t\t}\n\n\t\t\t// Add region content\n\t\t\tresult += text.substring(region.start, region.end);\n\t\t\tlastOffset = region.end;\n\t\t}\n\n\t\t// Add whitespace for remaining content\n\t\tif (lastOffset < text.length) {\n\t\t\tresult += \" \".repeat(text.length - lastOffset);\n\t\t}\n\n\t\treturn TextDocument.create(\n\t\t\tthis.document.uri + \".\" + languageId,\n\t\t\tlanguageId,\n\t\t\tthis.document.version,\n\t\t\tresult,\n\t\t);\n\t}\n\n\t/**\n\t * Check if position is inside any embedded region\n\t */\n\tisInEmbeddedRegion(position: Position): boolean {\n\t\treturn this.getLanguageAtPosition(position) !== null;\n\t}\n}\n","import { TextDocument, Position } from \"vscode-languageserver-textdocument\";\nimport { LanguageMode } from \"./language-modes\";\nimport { DocumentRegions } from \"./language-modes\";\n\n/**\n * Cache for document regions to avoid re-scanning\n */\nclass LanguageModelCache<T> {\n\tprivate cache: Map<string, { version: number; value: T }> = new Map();\n\tprivate maxEntries: number;\n\n\tconstructor(maxEntries: number = 10) {\n\t\tthis.maxEntries = maxEntries;\n\t}\n\n\tget(document: TextDocument): T {\n\t\tconst key = document.uri;\n\t\tconst entry = this.cache.get(key);\n\n\t\tif (entry && entry.version === document.version) {\n\t\t\treturn entry.value;\n\t\t}\n\n\t\t// Create new entry\n\t\tconst value = this.create(document);\n\t\tthis.cache.set(key, { version: document.version, value });\n\n\t\t// Cleanup old entries\n\t\tif (this.cache.size > this.maxEntries) {\n\t\t\tconst firstKey = this.cache.keys().next().value;\n\t\t\tif (firstKey !== undefined) {\n\t\t\t\tthis.cache.delete(firstKey);\n\t\t\t}\n\t\t}\n\n\t\treturn value;\n\t}\n\n\tprotected create(_document: TextDocument): T {\n\t\tthrow new Error(\"Must be implemented by subclass\");\n\t}\n}\n\n/**\n * Cache for document regions\n */\nexport class DocumentRegionsCache extends LanguageModelCache<DocumentRegions> {\n\tconstructor() {\n\t\tsuper(10);\n\t}\n\n\tprotected create(document: TextDocument): DocumentRegions {\n\t\treturn new DocumentRegions(document);\n\t}\n}\n\n/**\n * Manages language modes for embedded languages\n */\nexport class LanguageModes {\n\tprivate modes: Map<string, LanguageMode> = new Map();\n\tprivate documentRegions: DocumentRegionsCache;\n\n\tconstructor(documentRegions: DocumentRegionsCache) {\n\t\tthis.documentRegions = documentRegions;\n\t}\n\n\t/**\n\t * Register a language mode\n\t */\n\tregisterMode(mode: LanguageMode): void {\n\t\tthis.modes.set(mode.getId(), mode);\n\t}\n\n\t/**\n\t * Get language mode at a given position\n\t */\n\tgetModeAtPosition(\n\t\tdocument: TextDocument,\n\t\tposition: Position,\n\t): LanguageMode | null {\n\t\tconst regions = this.documentRegions.get(document);\n\t\tconst languageId = regions.getLanguageAtPosition(position);\n\n\t\tif (languageId) {\n\t\t\treturn this.modes.get(languageId) || null;\n\t\t}\n\n\t\t// Return default LootiScript mode (null means use default)\n\t\treturn null;\n\t}\n\n\t/**\n\t * Get all registered modes\n\t */\n\tgetAllModes(): LanguageMode[] {\n\t\treturn Array.from(this.modes.values());\n\t}\n\n\t/**\n\t * Get mode by language ID\n\t */\n\tgetMode(languageId: string): LanguageMode | null {\n\t\treturn this.modes.get(languageId) || null;\n\t}\n}\n","import { TextDocument } from \"vscode-languageserver-textdocument\";\nimport {\n\tPosition,\n\tCompletionList,\n\tHover,\n\tDiagnostic,\n\tDocumentSymbol,\n} from \"vscode-languageserver/node\";\nimport {\n\tLanguageService,\n\tgetLanguageService,\n} from \"vscode-json-languageservice\";\nimport { LanguageMode } from \"./language-modes\";\nimport { DocumentRegionsCache } from \"./mode-manager\";\n\n/**\n * JSON language mode for embedded JSON support\n */\nexport function getJSONMode(\n\tjsonLanguageService: LanguageService,\n\tdocumentRegionsCache: DocumentRegionsCache,\n): LanguageMode {\n\treturn {\n\t\tgetId() {\n\t\t\treturn \"json\";\n\t\t},\n\n\t\tasync doComplete(\n\t\t\tdocument: TextDocument,\n\t\t\tposition: Position,\n\t\t): Promise<CompletionList | null> {\n\t\t\t// Get virtual JSON document with all non-JSON content replaced with whitespace\n\t\t\tconst documentRegions = documentRegionsCache.get(document);\n\t\t\tconst embedded = documentRegions.getEmbeddedDocument(\"json\");\n\n\t\t\t// Parse JSON document\n\t\t\tconst jsonDocument = jsonLanguageService.parseJSONDocument(embedded);\n\n\t\t\t// Get completions\n\t\t\tconst completions = await jsonLanguageService.doComplete(\n\t\t\t\tembedded,\n\t\t\t\tposition,\n\t\t\t\tjsonDocument,\n\t\t\t);\n\n\t\t\treturn completions;\n\t\t},\n\n\t\tasync doHover(\n\t\t\tdocument: TextDocument,\n\t\t\tposition: Position,\n\t\t): Promise<Hover | null> {\n\t\t\tconst documentRegions = documentRegionsCache.get(document);\n\t\t\tconst embedded = documentRegions.getEmbeddedDocument(\"json\");\n\t\t\tconst jsonDocument = jsonLanguageService.parseJSONDocument(embedded);\n\n\t\t\treturn await jsonLanguageService.doHover(\n\t\t\t\tembedded,\n\t\t\t\tposition,\n\t\t\t\tjsonDocument,\n\t\t\t);\n\t\t},\n\n\t\tasync doValidation(document: TextDocument): Promise<Diagnostic[]> {\n\t\t\tconst documentRegions = documentRegionsCache.get(document);\n\t\t\tconst embedded = documentRegions.getEmbeddedDocument(\"json\");\n\t\t\tconst jsonDocument = jsonLanguageService.parseJSONDocument(embedded);\n\n\t\t\treturn await jsonLanguageService.doValidation(embedded, jsonDocument, {\n\t\t\t\tschemaValidation: \"error\",\n\t\t\t});\n\t\t},\n\n\t\tfindDocumentSymbols(document: TextDocument): DocumentSymbol[] {\n\t\t\tconst documentRegions = documentRegionsCache.get(document);\n\t\t\tconst embedded = documentRegions.getEmbeddedDocument(\"json\");\n\t\t\tconst jsonDocument = jsonLanguageService.parseJSONDocument(embedded);\n\n\t\t\t// Use findDocumentSymbols2 which returns DocumentSymbol[] instead of SymbolInformation[]\n\t\t\treturn jsonLanguageService.findDocumentSymbols2(embedded, jsonDocument);\n\t\t},\n\t};\n}\n\n/**\n * Create JSON language service instance\n */\nexport function createJSONLanguageService(): LanguageService {\n\treturn getLanguageService({\n\t\tschemaRequestService: async (_uri: string): Promise<string> => {\n\t\t\t// Return empty schema for now\n\t\t\t// Can be extended to load schemas from URLs\n\t\t\treturn \"\";\n\t\t},\n\t\tworkspaceContext: {\n\t\t\tresolveRelativePath: (relativePath: string, resource: string) => {\n\t\t\t\t// Simple path resolution\n\t\t\t\tconst base = resource.substring(0, resource.lastIndexOf(\"/\"));\n\t\t\t\treturn base + \"/\" + relativePath;\n\t\t\t},\n\t\t},\n\t});\n}\n","/**\n * Core utility API definitions (print, List, Math, String, JSON)\n */\n\nimport type { GlobalApi } from \"../types\";\n\nexport const coreApi: Partial<GlobalApi> = {\n\tprint: {\n\t\ttype: \"function\",\n\t\tdescription: \"Prints text to the debug console\",\n\t\tsignature: \"print(text: any)\",\n\t},\n\tList: {\n\t\ttype: \"module\",\n\t\tdescription: \"Array manipulation and functional programming utilities\",\n\t\tproperties: {\n\t\t\tmap: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"List.map(arr, fn)\",\n\t\t\t\tdescription: \"Map over array elements\",\n\t\t\t},\n\t\t\tfilter: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"List.filter(arr, fn)\",\n\t\t\t\tdescription: \"Filter array by predicate\",\n\t\t\t},\n\t\t\treduce: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"List.reduce(arr, fn, initial)\",\n\t\t\t\tdescription: \"Reduce array to single value\",\n\t\t\t},\n\t\t\tfind: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"List.find(arr, fn)\",\n\t\t\t\tdescription: \"Find first matching element\",\n\t\t\t},\n\t\t\tfindIndex: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"List.findIndex(arr, fn)\",\n\t\t\t\tdescription: \"Find index of first match\",\n\t\t\t},\n\t\t\tsome: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"List.some(arr, fn)\",\n\t\t\t\tdescription: \"Test if any element matches\",\n\t\t\t},\n\t\t\tevery: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"List.every(arr, fn)\",\n\t\t\t\tdescription: \"Test if all elements match\",\n\t\t\t},\n\t\t\treverse: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"List.reverse(arr)\",\n\t\t\t\tdescription: \"Reverse array (non-mutating)\",\n\t\t\t},\n\t\t\tsort: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"List.sort(arr, fn?)\",\n\t\t\t\tdescription: \"Sort array (non-mutating)\",\n\t\t\t},\n\t\t\tslice: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"List.slice(arr, start, end?)\",\n\t\t\t\tdescription: \"Extract array slice\",\n\t\t\t},\n\t\t\tconcat: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"List.concat(...arrays)\",\n\t\t\t\tdescription: \"Concatenate arrays\",\n\t\t\t},\n\t\t\tflat: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"List.flat(arr, depth?)\",\n\t\t\t\tdescription: \"Flatten nested array\",\n\t\t\t},\n\t\t\tflatMap: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"List.flatMap(arr, fn)\",\n\t\t\t\tdescription: \"Map and flatten array\",\n\t\t\t},\n\t\t\tindexOf: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"List.indexOf(arr, item, from?)\",\n\t\t\t\tdescription: \"Find first index of item\",\n\t\t\t},\n\t\t\tlastIndexOf: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"List.lastIndexOf(arr, item, from?)\",\n\t\t\t\tdescription: \"Find last index of item\",\n\t\t\t},\n\t\t\tincludes: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"List.includes(arr, item, from?)\",\n\t\t\t\tdescription: \"Check if array includes item\",\n\t\t\t},\n\t\t\tlength: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"List.length(arr)\",\n\t\t\t\tdescription: \"Get array length\",\n\t\t\t},\n\t\t\tfirst: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"List.first(arr)\",\n\t\t\t\tdescription: \"Get first element\",\n\t\t\t},\n\t\t\tlast: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"List.last(arr)\",\n\t\t\t\tdescription: \"Get last element\",\n\t\t\t},\n\t\t\tat: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"List.at(arr, index)\",\n\t\t\t\tdescription: \"Get element at index (supports negative)\",\n\t\t\t},\n\t\t\tpush: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"List.push(arr, ...items)\",\n\t\t\t\tdescription: \"Add items to end\",\n\t\t\t},\n\t\t\tpop: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"List.pop(arr)\",\n\t\t\t\tdescription: \"Remove and return last item\",\n\t\t\t},\n\t\t\tshift: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"List.shift(arr)\",\n\t\t\t\tdescription: \"Remove and return first item\",\n\t\t\t},\n\t\t\tunshift: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"List.unshift(arr, ...items)\",\n\t\t\t\tdescription: \"Add items to start\",\n\t\t\t},\n\t\t\tsplice: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"List.splice(arr, start, deleteCount?, ...items)\",\n\t\t\t\tdescription: \"Remove/insert elements\",\n\t\t\t},\n\t\t\tfill: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"List.fill(arr, value, start?, end?)\",\n\t\t\t\tdescription: \"Fill array with value\",\n\t\t\t},\n\t\t\tjoin: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"List.join(arr, separator?)\",\n\t\t\t\tdescription: \"Join array to string\",\n\t\t\t},\n\t\t\tunique: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"List.unique(arr)\",\n\t\t\t\tdescription: \"Remove duplicates\",\n\t\t\t},\n\t\t\tshuffle: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"List.shuffle(arr)\",\n\t\t\t\tdescription: \"Randomly shuffle array\",\n\t\t\t},\n\t\t\tchunk: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"List.chunk(arr, size)\",\n\t\t\t\tdescription: \"Split into chunks\",\n\t\t\t},\n\t\t\tsum: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"List.sum(arr)\",\n\t\t\t\tdescription: \"Sum numeric array\",\n\t\t\t},\n\t\t\taverage: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"List.average(arr)\",\n\t\t\t\tdescription: \"Average of numeric array\",\n\t\t\t},\n\t\t\tmin: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"List.min(arr)\",\n\t\t\t\tdescription: \"Minimum value in array\",\n\t\t\t},\n\t\t\tmax: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"List.max(arr)\",\n\t\t\t\tdescription: \"Maximum value in array\",\n\t\t\t},\n\t\t},\n\t},\n\tMath: {\n\t\ttype: \"module\",\n\t\tdescription: \"Mathematical and game-specific utilities\",\n\t\tproperties: {\n\t\t\tabs: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"Math.abs(x)\",\n\t\t\t\tdescription: \"Absolute value\",\n\t\t\t},\n\t\t\tsqrt: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"Math.sqrt(x)\",\n\t\t\t\tdescription: \"Square root\",\n\t\t\t},\n\t\t\tfloor: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"Math.floor(x)\",\n\t\t\t\tdescription: \"Round down\",\n\t\t\t},\n\t\t\tceil: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"Math.ceil(x)\",\n\t\t\t\tdescription: \"Round up\",\n\t\t\t},\n\t\t\tround: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"Math.round(x)\",\n\t\t\t\tdescription: \"Round to nearest\",\n\t\t\t},\n\t\t\tmin: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"Math.min(...args)\",\n\t\t\t\tdescription: \"Minimum value\",\n\t\t\t},\n\t\t\tmax: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"Math.max(...args)\",\n\t\t\t\tdescription: \"Maximum value\",\n\t\t\t},\n\t\t\tpow: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"Math.pow(base, exp)\",\n\t\t\t\tdescription: \"Power function\",\n\t\t\t},\n\t\t\texp: { type: \"method\", signature: \"Math.exp(x)\", description: \"e^x\" },\n\t\t\tlog: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"Math.log(x)\",\n\t\t\t\tdescription: \"Natural logarithm\",\n\t\t\t},\n\t\t\tlog10: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"Math.log10(x)\",\n\t\t\t\tdescription: \"Base-10 logarithm\",\n\t\t\t},\n\t\t\tsin: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"Math.sin(x)\",\n\t\t\t\tdescription: \"Sine (radians)\",\n\t\t\t},\n\t\t\tcos: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"Math.cos(x)\",\n\t\t\t\tdescription: \"Cosine (radians)\",\n\t\t\t},\n\t\t\ttan: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"Math.tan(x)\",\n\t\t\t\tdescription: \"Tangent (radians)\",\n\t\t\t},\n\t\t\tasin: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"Math.asin(x)\",\n\t\t\t\tdescription: \"Arcsine\",\n\t\t\t},\n\t\t\tacos: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"Math.acos(x)\",\n\t\t\t\tdescription: \"Arccosine\",\n\t\t\t},\n\t\t\tatan: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"Math.atan(x)\",\n\t\t\t\tdescription: \"Arctangent\",\n\t\t\t},\n\t\t\tatan2: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"Math.atan2(y, x)\",\n\t\t\t\tdescription: \"Two-argument arctangent\",\n\t\t\t},\n\t\t\trandom: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"Math.random()\",\n\t\t\t\tdescription: \"Random number 0-1\",\n\t\t\t},\n\t\t\trandomInt: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"Math.randomInt(min, max)\",\n\t\t\t\tdescription: \"Random integer\",\n\t\t\t},\n\t\t\trandomFloat: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"Math.randomFloat(min, max)\",\n\t\t\t\tdescription: \"Random float\",\n\t\t\t},\n\t\t\tPI: { type: \"property\", description: \"Pi constant (3.14159...)\" },\n\t\t\tE: { type: \"property\", description: \"Euler's number (2.71828...)\" },\n\t\t\tclamp: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"Math.clamp(value, min, max)\",\n\t\t\t\tdescription: \"Clamp value between min/max\",\n\t\t\t},\n\t\t\tlerp: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"Math.lerp(a, b, t)\",\n\t\t\t\tdescription: \"Linear interpolation\",\n\t\t\t},\n\t\t\tdistance: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"Math.distance(x1, y1, x2, y2)\",\n\t\t\t\tdescription: \"2D distance\",\n\t\t\t},\n\t\t\tdistance3D: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"Math.distance3D(x1, y1, z1, x2, y2, z2)\",\n\t\t\t\tdescription: \"3D distance\",\n\t\t\t},\n\t\t\tangleBetween: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"Math.angleBetween(x1, y1, x2, y2)\",\n\t\t\t\tdescription: \"Angle between points\",\n\t\t\t},\n\t\t\tdegToRad: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"Math.degToRad(degrees)\",\n\t\t\t\tdescription: \"Convert degrees to radians\",\n\t\t\t},\n\t\t\tradToDeg: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"Math.radToDeg(radians)\",\n\t\t\t\tdescription: \"Convert radians to degrees\",\n\t\t\t},\n\t\t\tsign: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"Math.sign(x)\",\n\t\t\t\tdescription: \"Sign of number (-1, 0, 1)\",\n\t\t\t},\n\t\t\tmod: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"Math.mod(n, m)\",\n\t\t\t\tdescription: \"Euclidean modulo\",\n\t\t\t},\n\t\t},\n\t},\n\tString: {\n\t\ttype: \"module\",\n\t\tdescription: \"String manipulation utilities\",\n\t\tproperties: {\n\t\t\tsplit: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"String.split(str, separator?)\",\n\t\t\t\tdescription: \"Split string into array\",\n\t\t\t},\n\t\t\tjoin: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"String.join(arr, separator?)\",\n\t\t\t\tdescription: \"Join array to string\",\n\t\t\t},\n\t\t\ttrim: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"String.trim(str)\",\n\t\t\t\tdescription: \"Remove whitespace from both ends\",\n\t\t\t},\n\t\t\ttrimStart: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"String.trimStart(str)\",\n\t\t\t\tdescription: \"Remove leading whitespace\",\n\t\t\t},\n\t\t\ttrimEnd: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"String.trimEnd(str)\",\n\t\t\t\tdescription: \"Remove trailing whitespace\",\n\t\t\t},\n\t\t\treplace: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"String.replace(str, search, replacement)\",\n\t\t\t\tdescription: \"Replace first occurrence\",\n\t\t\t},\n\t\t\treplaceAll: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"String.replaceAll(str, search, replacement)\",\n\t\t\t\tdescription: \"Replace all occurrences\",\n\t\t\t},\n\t\t\tstartsWith: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"String.startsWith(str, prefix)\",\n\t\t\t\tdescription: \"Check if string starts with prefix\",\n\t\t\t},\n\t\t\tendsWith: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"String.endsWith(str, suffix)\",\n\t\t\t\tdescription: \"Check if string ends with suffix\",\n\t\t\t},\n\t\t\tcontains: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"String.contains(str, search)\",\n\t\t\t\tdescription: \"Check if string contains substring\",\n\t\t\t},\n\t\t\ttoLowerCase: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"String.toLowerCase(str)\",\n\t\t\t\tdescription: \"Convert to lowercase\",\n\t\t\t},\n\t\t\ttoUpperCase: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"String.toUpperCase(str)\",\n\t\t\t\tdescription: \"Convert to uppercase\",\n\t\t\t},\n\t\t\tcharAt: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"String.charAt(str, index)\",\n\t\t\t\tdescription: \"Get character at index\",\n\t\t\t},\n\t\t\tcharCodeAt: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"String.charCodeAt(str, index)\",\n\t\t\t\tdescription: \"Get char code at index\",\n\t\t\t},\n\t\t\tfromCharCode: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"String.fromCharCode(...codes)\",\n\t\t\t\tdescription: \"Create string from char codes\",\n\t\t\t},\n\t\t\tsubstring: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"String.substring(str, start, end?)\",\n\t\t\t\tdescription: \"Extract substring\",\n\t\t\t},\n\t\t\tslice: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"String.slice(str, start, end?)\",\n\t\t\t\tdescription: \"Extract substring (supports negative indices)\",\n\t\t\t},\n\t\t\tindexOf: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"String.indexOf(str, search, from?)\",\n\t\t\t\tdescription: \"Find first index of substring\",\n\t\t\t},\n\t\t\tlastIndexOf: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"String.lastIndexOf(str, search, from?)\",\n\t\t\t\tdescription: \"Find last index of substring\",\n\t\t\t},\n\t\t\trepeat: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"String.repeat(str, count)\",\n\t\t\t\tdescription: \"Repeat string n times\",\n\t\t\t},\n\t\t\tpadStart: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"String.padStart(str, length, pad?)\",\n\t\t\t\tdescription: \"Pad string at start\",\n\t\t\t},\n\t\t\tpadEnd: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"String.padEnd(str, length, pad?)\",\n\t\t\t\tdescription: \"Pad string at end\",\n\t\t\t},\n\t\t\tlength: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"String.length(str)\",\n\t\t\t\tdescription: \"Get string length\",\n\t\t\t},\n\t\t\tparseInt: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"String.parseInt(str, radix?)\",\n\t\t\t\tdescription: \"Parse integer from string\",\n\t\t\t},\n\t\t\tparseFloat: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"String.parseFloat(str)\",\n\t\t\t\tdescription: \"Parse float from string\",\n\t\t\t},\n\t\t\tformat: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"String.format(template, ...args)\",\n\t\t\t\tdescription: \"Format string with {0}, {1}, etc.\",\n\t\t\t},\n\t\t},\n\t},\n\tJSON: {\n\t\ttype: \"module\",\n\t\tdescription: \"JSON encoding and decoding\",\n\t\tproperties: {\n\t\t\tencode: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"JSON.encode(value)\",\n\t\t\t\tdescription: \"Encode value to JSON string\",\n\t\t\t},\n\t\t\tdecode: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"JSON.decode(json)\",\n\t\t\t\tdescription: \"Decode JSON string to value\",\n\t\t\t},\n\t\t\tpretty: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"JSON.pretty(value, indent?)\",\n\t\t\t\tdescription: \"Pretty-print JSON with indentation\",\n\t\t\t},\n\t\t},\n\t},\n\tRandom: {\n\t\ttype: \"constructor\",\n\t\tdescription: \"Seeded random number generator for deterministic randomness\",\n\t\tsignature: \"new Random(seed?: number)\",\n\t\tproperties: {\n\t\t\tnext: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"random.next()\",\n\t\t\t\tdescription: \"Get next random number (0-1)\",\n\t\t\t},\n\t\t\tnextInt: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"random.nextInt(max)\",\n\t\t\t\tdescription: \"Get random integer (0 to max-1)\",\n\t\t\t},\n\t\t\tseed: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"random.seed(newSeed?)\",\n\t\t\t\tdescription: \"Set new seed value\",\n\t\t\t},\n\t\t\tclone: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"random.clone(seed?)\",\n\t\t\t\tdescription: \"Clone random generator with optional new seed\",\n\t\t\t},\n\t\t},\n\t},\n\tObjectPool: {\n\t\ttype: \"constructor\",\n\t\tdescription: \"Object pooling utility for performance optimization\",\n\t\tsignature: \"new ObjectPool(factory, maxSize?)\",\n\t\tproperties: {\n\t\t\tacquire: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"pool.acquire()\",\n\t\t\t\tdescription: \"Get object from pool or create new\",\n\t\t\t},\n\t\t\trelease: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"pool.release(obj)\",\n\t\t\t\tdescription: \"Return object to pool for reuse\",\n\t\t\t},\n\t\t\tclear: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"pool.clear()\",\n\t\t\t\tdescription: \"Clear all objects from pool\",\n\t\t\t},\n\t\t\tgetSize: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"pool.getSize()\",\n\t\t\t\tdescription: \"Get current pool size\",\n\t\t\t},\n\t\t\tgetMaxSize: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"pool.getMaxSize()\",\n\t\t\t\tdescription: \"Get maximum pool size\",\n\t\t\t},\n\t\t},\n\t},\n\tstorage: {\n\t\ttype: \"module\",\n\t\tdescription: \"Persistent storage API (localStorage wrapper)\",\n\t\tproperties: {\n\t\t\tget: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"storage.get(key, defaultValue?)\",\n\t\t\t\tdescription: \"Get value from storage\",\n\t\t\t},\n\t\t\tset: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"storage.set(key, value)\",\n\t\t\t\tdescription: \"Save value to storage\",\n\t\t\t},\n\t\t\tremove: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"storage.remove(key)\",\n\t\t\t\tdescription: \"Remove value from storage\",\n\t\t\t},\n\t\t\tclear: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"storage.clear()\",\n\t\t\t\tdescription: \"Clear all storage\",\n\t\t\t},\n\t\t\thas: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"storage.has(key)\",\n\t\t\t\tdescription: \"Check if key exists in storage\",\n\t\t\t},\n\t\t\tkeys: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"storage.keys()\",\n\t\t\t\tdescription: \"Get all storage keys\",\n\t\t\t},\n\t\t},\n\t},\n};\n","/**\n * Screen API definitions\n */\n\nimport type { GlobalApi } from \"../types\";\n\nexport const screenApi: Partial<GlobalApi> = {\n\tscreen: {\n\t\ttype: \"object\",\n\t\tdescription: \"Screen drawing and display interface\",\n\t\tproperties: {\n\t\t\twidth: {\n\t\t\t\ttype: \"property\",\n\t\t\t\tdescription: \"Screen width in pixels\",\n\t\t\t},\n\t\t\theight: {\n\t\t\t\ttype: \"property\",\n\t\t\t\tdescription: \"Screen height in pixels\",\n\t\t\t},\n\t\t\tdrawSprite: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Draw a sprite at the specified position\",\n\t\t\t\tsignature:\n\t\t\t\t\t\"screen.drawSprite(sprite: string, x: number, y: number, width?: number, height?: number)\",\n\t\t\t},\n\t\t\tfillRect: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Fill a rectangle with the current color\",\n\t\t\t\tsignature:\n\t\t\t\t\t\"screen.fillRect(x: number, y: number, width: number, height: number, color: string)\",\n\t\t\t},\n\t\t\tdrawRect: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Draw a rectangle outline\",\n\t\t\t\tsignature:\n\t\t\t\t\t\"screen.drawRect(x: number, y: number, width: number, height: number, color: string)\",\n\t\t\t},\n\t\t\tdrawText: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Draw text at the specified position\",\n\t\t\t\tsignature:\n\t\t\t\t\t\"screen.drawText(text: string, x: number, y: number, color?: string, size?: number)\",\n\t\t\t},\n\t\t\tclearScreen: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Clear the screen with a color\",\n\t\t\t\tsignature: \"screen.clearScreen(color?: string)\",\n\t\t\t},\n\t\t\tdrawCircle: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Draw a circle\",\n\t\t\t\tsignature:\n\t\t\t\t\t\"screen.drawCircle(x: number, y: number, radius: number, color: string)\",\n\t\t\t},\n\t\t\tfillCircle: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Fill a circle\",\n\t\t\t\tsignature:\n\t\t\t\t\t\"screen.fillCircle(x: number, y: number, radius: number, color: string)\",\n\t\t\t},\n\t\t\tdrawLine: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.drawLine(x1, y1, x2, y2, color?)\",\n\t\t\t\tdescription: \"Draw line between two points\",\n\t\t\t},\n\t\t\tclear: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.clear(color?)\",\n\t\t\t\tdescription: \"Clear screen (alias for clearScreen)\",\n\t\t\t},\n\t\t\tsetColor: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.setColor(color)\",\n\t\t\t\tdescription: \"Set drawing color\",\n\t\t\t},\n\t\t\tsetAlpha: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.setAlpha(alpha)\",\n\t\t\t\tdescription: \"Set opacity (0-1)\",\n\t\t\t},\n\t\t\tsetPixelated: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.setPixelated(pixelated)\",\n\t\t\t\tdescription: \"Enable/disable pixelated rendering\",\n\t\t\t},\n\t\t\tsetBlending: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.setBlending(mode)\",\n\t\t\t\tdescription: \"Set blending mode\",\n\t\t\t},\n\t\t\tsetLinearGradient: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.setLinearGradient(x1, y1, x2, y2, c1, c2)\",\n\t\t\t\tdescription: \"Set linear gradient\",\n\t\t\t},\n\t\t\tsetRadialGradient: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.setRadialGradient(x, y, radius, c1, c2)\",\n\t\t\t\tdescription: \"Set radial gradient\",\n\t\t\t},\n\t\t\tsetFont: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.setFont(font)\",\n\t\t\t\tdescription: \"Set font family\",\n\t\t\t},\n\t\t\tloadFont: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.loadFont(font)\",\n\t\t\t\tdescription: \"Load font\",\n\t\t\t},\n\t\t\tisFontReady: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.isFontReady(font?)\",\n\t\t\t\tdescription: \"Check if font is loaded\",\n\t\t\t},\n\t\t\tsetTranslation: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.setTranslation(tx, ty)\",\n\t\t\t\tdescription: \"Set translation offset\",\n\t\t\t},\n\t\t\tsetScale: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.setScale(x, y)\",\n\t\t\t\tdescription: \"Set scale\",\n\t\t\t},\n\t\t\tsetRotation: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.setRotation(rotation)\",\n\t\t\t\tdescription: \"Set rotation\",\n\t\t\t},\n\t\t\tsetDrawAnchor: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.setDrawAnchor(ax, ay)\",\n\t\t\t\tdescription: \"Set sprite drawing anchor\",\n\t\t\t},\n\t\t\tsetDrawRotation: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.setDrawRotation(rotation)\",\n\t\t\t\tdescription: \"Set sprite rotation\",\n\t\t\t},\n\t\t\tsetDrawScale: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.setDrawScale(x, y?)\",\n\t\t\t\tdescription: \"Set sprite scale\",\n\t\t\t},\n\t\t\tfillRoundRect: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.fillRoundRect(x, y, w, h, r?, color?)\",\n\t\t\t\tdescription: \"Fill rounded rectangle\",\n\t\t\t},\n\t\t\tfillRound: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.fillRound(x, y, w, h, color?)\",\n\t\t\t\tdescription: \"Fill round (ellipse in rect)\",\n\t\t\t},\n\t\t\tdrawRoundRect: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.drawRoundRect(x, y, w, h, r?, color?)\",\n\t\t\t\tdescription: \"Draw rounded rectangle outline\",\n\t\t\t},\n\t\t\tdrawRound: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.drawRound(x, y, w, h, color?)\",\n\t\t\t\tdescription: \"Draw round outline\",\n\t\t\t},\n\t\t\tdrawImage: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.drawImage(sprite, x, y, w?, h?)\",\n\t\t\t\tdescription: \"Draw image (alias for drawSprite)\",\n\t\t\t},\n\t\t\tdrawSpritePart: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature:\n\t\t\t\t\t\"screen.drawSpritePart(sprite, sx, sy, sw, sh, x, y, w?, h?)\",\n\t\t\t\tdescription: \"Draw part of sprite\",\n\t\t\t},\n\t\t\tdrawImagePart: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.drawImagePart(sprite, sx, sy, sw, sh, x, y, w?, h?)\",\n\t\t\t\tdescription: \"Draw part of image\",\n\t\t\t},\n\t\t\tdrawMap: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.drawMap(map, x, y, w, h)\",\n\t\t\t\tdescription: \"Draw tile map\",\n\t\t\t},\n\t\t\tdrawTextOutline: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.drawTextOutline(text, x, y, size, color?)\",\n\t\t\t\tdescription: \"Draw text with outline\",\n\t\t\t},\n\t\t\ttextWidth: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.textWidth(text, size)\",\n\t\t\t\tdescription: \"Measure text width\",\n\t\t\t},\n\t\t\tsetLineWidth: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.setLineWidth(width)\",\n\t\t\t\tdescription: \"Set line width\",\n\t\t\t},\n\t\t\tsetLineDash: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.setLineDash(dash)\",\n\t\t\t\tdescription: \"Set line dash pattern\",\n\t\t\t},\n\t\t\tdrawPolygon: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.drawPolygon(...points)\",\n\t\t\t\tdescription: \"Draw polygon outline\",\n\t\t\t},\n\t\t\tdrawPolyline: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.drawPolyline(...points)\",\n\t\t\t\tdescription: \"Draw polyline\",\n\t\t\t},\n\t\t\tfillPolygon: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.fillPolygon(...points)\",\n\t\t\t\tdescription: \"Fill polygon\",\n\t\t\t},\n\t\t\tdrawQuadCurve: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.drawQuadCurve(...args)\",\n\t\t\t\tdescription: \"Draw quadratic curve\",\n\t\t\t},\n\t\t\tdrawBezierCurve: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.drawBezierCurve(...args)\",\n\t\t\t\tdescription: \"Draw bezier curve\",\n\t\t\t},\n\t\t\tdrawArc: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.drawArc(x, y, radius, angle1, angle2, ccw, color?)\",\n\t\t\t\tdescription: \"Draw arc\",\n\t\t\t},\n\t\t\tfillArc: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.fillArc(x, y, radius, angle1, angle2, ccw, color?)\",\n\t\t\t\tdescription: \"Fill arc\",\n\t\t\t},\n\t\t\tsetCursorVisible: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.setCursorVisible(visible)\",\n\t\t\t\tdescription: \"Show/hide cursor\",\n\t\t\t},\n\t\t\ttri: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.tri(x1, y1, x2, y2, x3, y3, color?)\",\n\t\t\t\tdescription: \"Draw triangle outline\",\n\t\t\t},\n\t\t\ttrib: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"screen.trib(x1, y1, x2, y2, x3, y3, color?)\",\n\t\t\t\tdescription: \"Fill triangle\",\n\t\t\t},\n\t\t\tttri: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature:\n\t\t\t\t\t\"screen.ttri(x1, y1, x2, y2, x3, y3, u1, v1, u2, v2, u3, v3, texture, ...)\",\n\t\t\t\tdescription: \"Textured triangle (3D)\",\n\t\t\t},\n\t\t},\n\t},\n};\n","/**\n * Audio API definitions\n */\n\nimport type { GlobalApi } from \"../types\";\n\nexport const audioApi: Partial<GlobalApi> = {\n\taudio: {\n\t\ttype: \"object\",\n\t\tdescription: \"Audio playback and sound interface\",\n\t\tproperties: {\n\t\t\tbeep: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Play a beep sound\",\n\t\t\t\tsignature: \"audio.beep(frequency?: number, duration?: number)\",\n\t\t\t},\n\t\t\tplaySound: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Play a sound file\",\n\t\t\t\tsignature:\n\t\t\t\t\t\"audio.playSound(soundName: string, volume?: number, loop?: boolean)\",\n\t\t\t},\n\t\t\tstopSound: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Stop a playing sound\",\n\t\t\t\tsignature: \"audio.stopSound(soundName: string)\",\n\t\t\t},\n\t\t\tsetVolume: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Set the master volume\",\n\t\t\t\tsignature: \"audio.setVolume(volume: number)\",\n\t\t\t},\n\t\t\tplayMusic: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Play background music\",\n\t\t\t\tsignature:\n\t\t\t\t\t\"audio.playMusic(musicName: string, volume?: number, loop?: boolean)\",\n\t\t\t},\n\t\t\tstopMusic: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Stop background music\",\n\t\t\t\tsignature: \"audio.stopMusic()\",\n\t\t\t},\n\t\t},\n\t},\n};\n","/**\n * Input API definitions\n */\n\nimport type { GlobalApi } from \"../types\";\n\nexport const inputApi: Partial<GlobalApi> = {\n\tinput: {\n\t\ttype: \"object\",\n\t\tdescription: \"User input interface (keyboard, mouse, touch, gamepad)\",\n\t\tproperties: {\n\t\t\tkeyboard: {\n\t\t\t\ttype: \"property\",\n\t\t\t\tdescription: \"Keyboard input state object\",\n\t\t\t},\n\t\t\tmouse: {\n\t\t\t\ttype: \"property\",\n\t\t\t\tdescription:\n\t\t\t\t\t\"Mouse input state object with x, y, and button properties\",\n\t\t\t},\n\t\t\ttouch: {\n\t\t\t\ttype: \"property\",\n\t\t\t\tdescription: \"Touch input state for mobile devices\",\n\t\t\t},\n\t\t\tgamepad: {\n\t\t\t\ttype: \"property\",\n\t\t\t\tdescription: \"Gamepad input state\",\n\t\t\t},\n\t\t},\n\t},\n};\n","/**\n * System API definitions\n */\n\nimport type { GlobalApi } from \"../types\";\n\nexport const systemApi: Partial<GlobalApi> = {\n\tsystem: {\n\t\ttype: \"object\",\n\t\tdescription: \"Runtime system utilities and information\",\n\t\tproperties: {\n\t\t\ttime: {\n\t\t\t\ttype: \"property\",\n\t\t\t\tdescription: \"Current system time in milliseconds\",\n\t\t\t},\n\t\t\tfps: { type: \"property\", description: \"Current frames per second\" },\n\t\t\tdeltaTime: {\n\t\t\t\ttype: \"property\",\n\t\t\t\tdescription: \"Time elapsed since last frame (seconds)\",\n\t\t\t},\n\t\t\tcpu_load: { type: \"property\", description: \"CPU load percentage\" },\n\t\t\tupdate_rate: { type: \"property\", description: \"Target update rate\" },\n\t\t\tlanguage: { type: \"property\", description: \"Browser language\" },\n\t\t\tloading: {\n\t\t\t\ttype: \"property\",\n\t\t\t\tdescription: \"Asset loading progress (0-1)\",\n\t\t\t},\n\t\t\tinputs: { type: \"property\", description: \"Input device availability\" },\n\t\t\tpause: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"system.pause()\",\n\t\t\t\tdescription: \"Pause game execution\",\n\t\t\t},\n\t\t\texit: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"system.exit()\",\n\t\t\t\tdescription: \"Exit game\",\n\t\t\t},\n\t\t\tprompt: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"system.prompt(text, callback)\",\n\t\t\t\tdescription: \"Prompt user for input\",\n\t\t\t},\n\t\t\tsay: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"system.say(text)\",\n\t\t\t\tdescription: \"Show alert message\",\n\t\t\t},\n\t\t},\n\t},\n};\n","/**\n * Scene API definitions\n */\n\nimport type { GlobalApi } from \"../types\";\n\nexport const sceneApi: Partial<GlobalApi> = {\n\tscene: {\n\t\ttype: \"function\",\n\t\tdescription: \"Register a new scene\",\n\t\tsignature: \"scene(name: string, definition: object)\",\n\t},\n\troute: {\n\t\ttype: \"function\",\n\t\tdescription: \"Register a route to a scene\",\n\t\tsignature: \"route(path: string, sceneName: string)\",\n\t},\n\trouter: {\n\t\ttype: \"object\",\n\t\tdescription: \"Router for navigation\",\n\t\tproperties: {\n\t\t\tpush: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Navigate to a path (adds to history)\",\n\t\t\t\tsignature: \"router.push(path: string)\",\n\t\t\t},\n\t\t\treplace: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Replace current path (no history)\",\n\t\t\t\tsignature: \"router.replace(path: string)\",\n\t\t\t},\n\t\t\tback: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Go back in history\",\n\t\t\t\tsignature: \"router.back()\",\n\t\t\t},\n\t\t\tpath: {\n\t\t\t\ttype: \"property\",\n\t\t\t\tdescription: \"Current path\",\n\t\t\t},\n\t\t\tparams: {\n\t\t\t\ttype: \"property\",\n\t\t\t\tdescription: \"Current route parameters\",\n\t\t\t},\n\t\t\tsceneName: {\n\t\t\t\ttype: \"property\",\n\t\t\t\tdescription: \"Current scene name\",\n\t\t\t},\n\t\t\tgetPath: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Get current path\",\n\t\t\t\tsignature: \"router.getPath()\",\n\t\t\t},\n\t\t\tgetParams: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Get current route parameters\",\n\t\t\t\tsignature: \"router.getParams()\",\n\t\t\t},\n\t\t\tgetSceneName: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Get current scene name\",\n\t\t\t\tsignature: \"router.getSceneName()\",\n\t\t\t},\n\t\t},\n\t},\n\tscenes: {\n\t\ttype: \"object\",\n\t\tdescription: \"Scene manager\",\n\t\tproperties: {\n\t\t\tgoto: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Directly switch to a scene\",\n\t\t\t\tsignature: \"scenes.goto(name: string, params?: object)\",\n\t\t\t},\n\t\t\tcurrent: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Get current scene name\",\n\t\t\t\tsignature: \"scenes.current()\",\n\t\t\t},\n\t\t},\n\t},\n};\n","/**\n * Sprites API definitions\n */\n\nimport type { GlobalApi } from \"../types\";\n\nexport const spritesApi: Partial<GlobalApi> = {\n\tSprite: {\n\t\ttype: \"class\",\n\t\tdescription: \"Animated sprite class\",\n\t\tsignature: \"new Sprite(options)\",\n\t\tproperties: {\n\t\t\tplay: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Play animation\",\n\t\t\t\tsignature: \"sprite.play(animation?)\",\n\t\t\t},\n\t\t\tstop: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Stop animation\",\n\t\t\t\tsignature: \"sprite.stop()\",\n\t\t\t},\n\t\t\tupdate: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Update sprite state\",\n\t\t\t\tsignature: \"sprite.update(dt)\",\n\t\t\t},\n\t\t\tdraw: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Draw sprite\",\n\t\t\t\tsignature: \"sprite.draw(x, y, w?, h?)\",\n\t\t\t},\n\t\t},\n\t},\n\tImage: {\n\t\ttype: \"class\",\n\t\tdescription: \"Image resource wrapper\",\n\t\tsignature: \"new Image(source)\",\n\t},\n\tloadSprite: {\n\t\ttype: \"function\",\n\t\tdescription: \"Load a sprite from source\",\n\t\tsignature: \"loadSprite(src, options?)\",\n\t},\n\tupdateSprite: {\n\t\ttype: \"function\",\n\t\tdescription: \"Update a sprite definition\",\n\t\tsignature: \"updateSprite(name, definition)\",\n\t},\n\tloadFont: {\n\t\ttype: \"function\",\n\t\tdescription: \"Load a font\",\n\t\tsignature: \"loadFont(name, src, options?)\",\n\t},\n\tisFontReady: {\n\t\ttype: \"function\",\n\t\tdescription: \"Check if a font is loaded\",\n\t\tsignature: \"isFontReady(name)\",\n\t},\n\tclearFontCache: {\n\t\ttype: \"function\",\n\t\tdescription: \"Clear font cache\",\n\t\tsignature: \"clearFontCache()\",\n\t},\n};\n","/**\n * Map API definitions\n */\n\nimport type { GlobalApi } from \"../types\";\n\nexport const mapApi: Partial<GlobalApi> = {\n\tMap: {\n\t\ttype: \"class\",\n\t\tdescription: \"Tile map class\",\n\t\tsignature: \"new Map(data)\",\n\t\tproperties: {\n\t\t\twidth: {\n\t\t\t\ttype: \"property\",\n\t\t\t\tdescription: \"Map width in tiles\",\n\t\t\t},\n\t\t\theight: {\n\t\t\t\ttype: \"property\",\n\t\t\t\tdescription: \"Map height in tiles\",\n\t\t\t},\n\t\t\ttileWidth: {\n\t\t\t\ttype: \"property\",\n\t\t\t\tdescription: \"Tile width in pixels\",\n\t\t\t},\n\t\t\ttileHeight: {\n\t\t\t\ttype: \"property\",\n\t\t\t\tdescription: \"Tile height in pixels\",\n\t\t\t},\n\t\t\tgetTile: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Get tile at coordinates\",\n\t\t\t\tsignature: \"map.getTile(layer, x, y)\",\n\t\t\t},\n\t\t\tsetTile: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Set tile at coordinates\",\n\t\t\t\tsignature: \"map.setTile(layer, x, y, tile)\",\n\t\t\t},\n\t\t},\n\t},\n\tloadMap: {\n\t\ttype: \"function\",\n\t\tdescription: \"Load a map from source\",\n\t\tsignature: \"loadMap(src)\",\n\t},\n\tsaveMap: {\n\t\ttype: \"function\",\n\t\tdescription: \"Save map data\",\n\t\tsignature: \"saveMap(map)\",\n\t},\n\tupdateMap: {\n\t\ttype: \"function\",\n\t\tdescription: \"Update map definition\",\n\t\tsignature: \"updateMap(name, definition)\",\n\t},\n};\n","/**\n * Time API definitions\n */\n\nimport type { GlobalApi } from \"../types\";\n\nexport const timeApi: Partial<GlobalApi> = {\n\tTimeMachine: {\n\t\ttype: \"class\",\n\t\tdescription: \"Time travel debugging system\",\n\t\tsignature: \"new TimeMachine(options)\",\n\t\tproperties: {\n\t\t\trecord: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Start recording state\",\n\t\t\t\tsignature: \"timeMachine.record()\",\n\t\t\t},\n\t\t\tplay: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Play back recorded state\",\n\t\t\t\tsignature: \"timeMachine.play()\",\n\t\t\t},\n\t\t\tstop: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Stop recording/playback\",\n\t\t\t\tsignature: \"timeMachine.stop()\",\n\t\t\t},\n\t\t\trewind: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Rewind state\",\n\t\t\t\tsignature: \"timeMachine.rewind(steps)\",\n\t\t\t},\n\t\t},\n\t},\n\tStatePlayer: {\n\t\ttype: \"class\",\n\t\tdescription: \"State playback controller\",\n\t\tsignature: \"new StatePlayer(timeMachine)\",\n\t},\n\tStateRecorder: {\n\t\ttype: \"class\",\n\t\tdescription: \"State recorder\",\n\t\tsignature: \"new StateRecorder(timeMachine)\",\n\t},\n};\n","/**\n * Assets API definitions\n */\n\nimport type { GlobalApi } from \"../types\";\n\nexport const assetsApi: Partial<GlobalApi> = {\n\tAssetManager: {\n\t\ttype: \"class\",\n\t\tdescription: \"Asset management system\",\n\t\tsignature: \"new AssetManager(options)\",\n\t\tproperties: {\n\t\t\tload: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Load an asset\",\n\t\t\t\tsignature: \"assetManager.load(src, type?)\",\n\t\t\t},\n\t\t\tget: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Get a loaded asset\",\n\t\t\t\tsignature: \"assetManager.get(src)\",\n\t\t\t},\n\t\t\tunload: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Unload an asset\",\n\t\t\t\tsignature: \"assetManager.unload(src)\",\n\t\t\t},\n\t\t},\n\t},\n};\n","/**\n * Palette API definitions\n */\n\nimport type { GlobalApi } from \"../types\";\n\nexport const paletteApi: Partial<GlobalApi> = {\n\tPalette: {\n\t\ttype: \"class\",\n\t\tdescription: \"Color palette management\",\n\t\tsignature: \"new Palette(colors)\",\n\t\tproperties: {\n\t\t\tget: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Get color by index\",\n\t\t\t\tsignature: \"palette.get(index)\",\n\t\t\t},\n\t\t\tset: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tdescription: \"Set color at index\",\n\t\t\t\tsignature: \"palette.set(index, color)\",\n\t\t\t},\n\t\t\tsize: {\n\t\t\t\ttype: \"property\",\n\t\t\t\tdescription: \"Number of colors in palette\",\n\t\t\t},\n\t\t},\n\t},\n};\n","/**\n * Player API definitions\n */\n\nimport type { GlobalApi } from \"../types\";\n\nexport const playerApi: Partial<GlobalApi> = {\n\tplayer: {\n\t\ttype: \"object\",\n\t\tdescription: \"Farcaster player context and user information\",\n\t\tproperties: {\n\t\t\tfid: {\n\t\t\t\ttype: \"property\",\n\t\t\t\tdescription: \"Player Farcaster ID (FID)\",\n\t\t\t},\n\t\t\tusername: {\n\t\t\t\ttype: \"property\",\n\t\t\t\tdescription: \"Player username\",\n\t\t\t},\n\t\t\tdisplayName: {\n\t\t\t\ttype: \"property\",\n\t\t\t\tdescription: \"Player display name\",\n\t\t\t},\n\t\t\tpfpUrl: {\n\t\t\t\ttype: \"property\",\n\t\t\t\tdescription: \"Player profile picture URL\",\n\t\t\t},\n\t\t\tgetFid: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"player.getFid()\",\n\t\t\t\tdescription: \"Get player Farcaster ID\",\n\t\t\t},\n\t\t\tgetUsername: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"player.getUsername()\",\n\t\t\t\tdescription: \"Get player username\",\n\t\t\t},\n\t\t\tgetDisplayName: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"player.getDisplayName()\",\n\t\t\t\tdescription: \"Get player display name\",\n\t\t\t},\n\t\t\tgetPfpUrl: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"player.getPfpUrl()\",\n\t\t\t\tdescription: \"Get player profile picture URL\",\n\t\t\t},\n\t\t\tgetContext: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"player.getContext()\",\n\t\t\t\tdescription: \"Get full player context object\",\n\t\t\t},\n\t\t\tisInMiniApp: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"player.isInMiniApp()\",\n\t\t\t\tdescription: \"Check if running in Farcaster Mini App\",\n\t\t\t},\n\t\t},\n\t},\n};\n","/**\n * Wallet API definitions\n */\n\nimport type { GlobalApi } from \"../types\";\n\nexport const walletApi: Partial<GlobalApi> = {\n\twallet: {\n\t\ttype: \"object\",\n\t\tdescription: \"Wallet operations for Farcaster Mini Apps\",\n\t\tproperties: {\n\t\t\tisConnected: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"wallet.isConnected()\",\n\t\t\t\tdescription: \"Check if wallet is connected\",\n\t\t\t},\n\t\t\tconnect: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"wallet.connect()\",\n\t\t\t\tdescription: \"Connect to wallet\",\n\t\t\t},\n\t\t\tgetAddress: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"wallet.getAddress()\",\n\t\t\t\tdescription: \"Get connected wallet address\",\n\t\t\t},\n\t\t\tgetChainId: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"wallet.getChainId()\",\n\t\t\t\tdescription: \"Get current chain ID\",\n\t\t\t},\n\t\t\tsendTransaction: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature:\n\t\t\t\t\t\"wallet.sendTransaction({to: string, value?: string, data?: string})\",\n\t\t\t\tdescription: \"Send a transaction\",\n\t\t\t},\n\t\t\tsignMessage: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"wallet.signMessage(message: string)\",\n\t\t\t\tdescription: \"Sign a message\",\n\t\t\t},\n\t\t},\n\t},\n};\n","/**\n * EVM API definitions\n */\n\nimport type { GlobalApi } from \"../types\";\n\nexport const evmApi: Partial<GlobalApi> = {\n\tevm: {\n\t\ttype: \"object\",\n\t\tdescription: \"EVM blockchain operations using viem\",\n\t\tproperties: {\n\t\t\tread: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature:\n\t\t\t\t\t\"evm.read(contractAddress: string, abi: any, functionName: string, args?: any[])\",\n\t\t\t\tdescription: \"Read from smart contract (view function, no transaction)\",\n\t\t\t},\n\t\t\twrite: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature:\n\t\t\t\t\t\"evm.write(contractAddress: string, abi: any, functionName: string, args?: any[])\",\n\t\t\t\tdescription:\n\t\t\t\t\t\"Write to smart contract (state-changing, sends transaction)\",\n\t\t\t},\n\t\t\tcall: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature:\n\t\t\t\t\t\"evm.call(contractAddress: string, abi: any, functionName: string, args?: any[])\",\n\t\t\t\tdescription: \"Call/simulate contract function (no transaction)\",\n\t\t\t},\n\t\t\tgetBalance: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"evm.getBalance(address?: string)\",\n\t\t\t\tdescription: \"Get ETH balance for an address\",\n\t\t\t},\n\t\t\tformatEther: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"evm.formatEther(value: string)\",\n\t\t\t\tdescription: \"Format wei to ether (wei / 10^18)\",\n\t\t\t},\n\t\t\tparseEther: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"evm.parseEther(value: string)\",\n\t\t\t\tdescription: \"Parse ether to wei (ether * 10^18)\",\n\t\t\t},\n\t\t},\n\t},\n};\n","/**\n * Actions API definitions for Farcaster Mini Apps\n */\n\nimport type { GlobalApi } from \"../types\";\n\nexport const actionsApi: Partial<GlobalApi> = {\n\tactions: {\n\t\ttype: \"object\",\n\t\tdescription: \"Farcaster SDK actions for Mini Apps\",\n\t\tproperties: {\n\t\t\tready: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"actions.ready(disableNativeGestures?: boolean)\",\n\t\t\t\tdescription: \"Hide the splash screen and display your app content\",\n\t\t\t},\n\t\t\tclose: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"actions.close()\",\n\t\t\t\tdescription: \"Close the Mini App\",\n\t\t\t},\n\t\t\tshare: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"actions.share({text?: string, embeds?: string[]})\",\n\t\t\t\tdescription: \"Share content via compose cast\",\n\t\t\t},\n\t\t\tsignIn: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature:\n\t\t\t\t\t\"actions.signIn({nonce: string, acceptAuthAddress?: boolean})\",\n\t\t\t\tdescription:\n\t\t\t\t\t\"Request Sign In with Farcaster credential. Returns {signature: string, message: string}\",\n\t\t\t},\n\t\t\taddMiniApp: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"actions.addMiniApp()\",\n\t\t\t\tdescription: \"Prompt the user to add the Mini App to their client\",\n\t\t\t},\n\t\t\topenMiniApp: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"actions.openMiniApp({url: string})\",\n\t\t\t\tdescription: \"Open another Mini App\",\n\t\t\t},\n\t\t\topenUrl: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"actions.openUrl({url: string})\",\n\t\t\t\tdescription: \"Open an external URL\",\n\t\t\t},\n\t\t\tviewProfile: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"actions.viewProfile({fid: number})\",\n\t\t\t\tdescription: \"View a Farcaster profile\",\n\t\t\t},\n\t\t\tviewCast: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"actions.viewCast({hash: string, close?: boolean})\",\n\t\t\t\tdescription: \"View a specific cast\",\n\t\t\t},\n\t\t\tswapToken: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature:\n\t\t\t\t\t\"actions.swapToken({sellToken?: string, buyToken?: string, sellAmount?: string})\",\n\t\t\t\tdescription: \"Open swap form with pre-filled tokens\",\n\t\t\t},\n\t\t\tsendToken: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature:\n\t\t\t\t\t\"actions.sendToken({token?: string, amount?: string, recipientAddress?: string, recipientFid?: number})\",\n\t\t\t\tdescription: \"Open send form with pre-filled token and recipient\",\n\t\t\t},\n\t\t\tviewToken: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature: \"actions.viewToken({token: string})\",\n\t\t\t\tdescription: \"View a token\",\n\t\t\t},\n\t\t\tcomposeCast: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature:\n\t\t\t\t\t\"actions.composeCast({text?: string, embeds?: string[], parent?: {type: string, hash: string}, close?: boolean, channelKey?: string})\",\n\t\t\t\tdescription: \"Open cast composer with suggested content\",\n\t\t\t},\n\t\t},\n\t},\n};\n","/**\n * HTTP API definitions\n */\n\nimport type { GlobalApi } from \"../types\";\n\nexport const httpApi: Partial<GlobalApi> = {\n\thttp: {\n\t\ttype: \"object\",\n\t\tdescription: \"HTTP client for external API requests\",\n\t\tproperties: {\n\t\t\trequest: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature:\n\t\t\t\t\t\"http.request(url: string, options?: {method?: string, headers?: object, body?: any, timeout?: number})\",\n\t\t\t\tdescription: \"Make a custom HTTP request with full control\",\n\t\t\t},\n\t\t\tget: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature:\n\t\t\t\t\t\"http.get(url: string, options?: {headers?: object, timeout?: number})\",\n\t\t\t\tdescription: \"Make a GET request\",\n\t\t\t},\n\t\t\tpost: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature:\n\t\t\t\t\t\"http.post(url: string, body?: any, options?: {headers?: object, timeout?: number})\",\n\t\t\t\tdescription: \"Make a POST request\",\n\t\t\t},\n\t\t\tput: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature:\n\t\t\t\t\t\"http.put(url: string, body?: any, options?: {headers?: object, timeout?: number})\",\n\t\t\t\tdescription: \"Make a PUT request\",\n\t\t\t},\n\t\t\tdelete: {\n\t\t\t\ttype: \"method\",\n\t\t\t\tsignature:\n\t\t\t\t\t\"http.delete(url: string, options?: {headers?: object, timeout?: number})\",\n\t\t\t\tdescription: \"Make a DELETE request\",\n\t\t\t},\n\t\t},\n\t},\n};\n","/**\n * API definitions index - combines all API categories\n */\n\nimport type { GlobalApi } from \"../types\";\nimport { coreApi } from \"./core\";\nimport { screenApi } from \"./screen\";\nimport { audioApi } from \"./audio\";\nimport { inputApi } from \"./input\";\nimport { systemApi } from \"./system\";\nimport { sceneApi } from \"./scene\";\nimport { spritesApi } from \"./sprites\";\nimport { mapApi } from \"./map\";\nimport { timeApi } from \"./time\";\nimport { assetsApi } from \"./assets\";\nimport { paletteApi } from \"./palette\";\nimport { playerApi } from \"./player\";\nimport { walletApi } from \"./wallet\";\nimport { evmApi } from \"./evm\";\nimport { actionsApi } from \"./actions\";\nimport { httpApi } from \"./http\";\n\n/**\n * Global API list for suggestions and hover info\n */\nexport const GLOBAL_API: GlobalApi = {\n\t...coreApi,\n\t...screenApi,\n\t...audioApi,\n\t...inputApi,\n\t...systemApi,\n\t...sceneApi,\n\t...spritesApi,\n\t...mapApi,\n\t...timeApi,\n\t...assetsApi,\n\t...paletteApi,\n\t...playerApi,\n\t...walletApi,\n\t...evmApi,\n\t...actionsApi,\n\t...httpApi,\n} as GlobalApi;\n\n/**\n * Regex to match API access patterns:\n * - Single level: \"screen.drawSprite\", \"Math.abs\"\n * - Nested: \"sprites.player.x\", \"map.level1.width\"\n */\nexport const API_ACCESS_REGEX =\n\t/\\b([A-Za-z_][A-Za-z0-9_]*(?:\\.[A-Za-z_][A-Za-z0-9_]*)*)\\.([A-Za-z_][A-Za-z0-9_]*)\\b/g;\n","import { TextDocument } from \"vscode-languageserver-textdocument\";\nimport { Parser } from \"@l8b/lootiscript/dist/v1/parser\";\nimport { Range, Position } from \"vscode-languageserver/node\";\nimport { Connection } from \"vscode-languageserver/node\";\nimport { ASTNode, Scope, SymbolInfo, DocumentState } from \"./types\";\n\nconst documentStates: Map<string, DocumentState> = new Map();\n\nexport function getDocumentStates(): Map<string, DocumentState> {\n\treturn documentStates;\n}\n\nexport function updateDocumentState(\n\ttextDocument: TextDocument,\n\tconnection: Connection,\n): void {\n\tconst text = textDocument.getText();\n\tconst state: DocumentState = {\n\t\ttextDocument,\n\t\tast: null,\n\t\tscope: null,\n\t\tsymbols: [],\n\t};\n\n\ttry {\n\t\tconst parser = new Parser(text, textDocument.uri);\n\t\tparser.parse();\n\n\t\tconst ast = convertParserAst(parser);\n\t\tconst scope = buildScope(ast);\n\t\tconst symbols = collectSymbols(ast, textDocument.uri);\n\n\t\tstate.ast = ast;\n\t\tstate.scope = scope;\n\t\tstate.symbols = symbols;\n\t} catch (err) {\n\t\tconnection.console.error(`AST build failed: ${err}`);\n\t}\n\n\tdocumentStates.set(textDocument.uri, state);\n}\n\nexport function deleteDocumentState(uri: string): void {\n\tdocumentStates.delete(uri);\n}\n\nfunction convertParserAst(parser: any): ASTNode | null {\n\tconst root = {\n\t\ttype: \"root\",\n\t\tline: 1,\n\t\tcolumn: 0,\n\t\tchildren: [],\n\t\tscope: {\n\t\t\tsymbols: new Map(),\n\t\t},\n\t} as ASTNode;\n\n\tconst statements = parser.program?.statements || [];\n\tfor (const stmt of statements) {\n\t\troot.children?.push(convertNode(stmt));\n\t}\n\n\treturn root;\n}\n\nfunction convertNode(node: any): ASTNode {\n\tconst base: ASTNode = {\n\t\ttype: node.constructor?.name || \"Unknown\",\n\t\tline: node?.token?.line || 1,\n\t\tcolumn: node?.token?.column || 0,\n\t\tendLine: node?.token?.line || 1,\n\t\tendColumn: node?.token?.column || 0,\n\t\tchildren: [],\n\t};\n\n\tif (node.identifier) {\n\t\tbase.name = node.identifier;\n\t}\n\n\tif (node.sequence) {\n\t\tfor (const child of node.sequence) {\n\t\t\tbase.children?.push(convertNode(child));\n\t\t}\n\t}\n\n\tif (node.body) {\n\t\tfor (const child of node.body) {\n\t\t\tbase.children?.push(convertNode(child));\n\t\t}\n\t}\n\n\tif (node.expression) {\n\t\tbase.children?.push(convertNode(node.expression));\n\t}\n\n\tif (node.statements) {\n\t\tfor (const child of node.statements) {\n\t\t\tbase.children?.push(convertNode(child));\n\t\t}\n\t}\n\n\tif (node.function_body) {\n\t\tfor (const child of node.function_body) {\n\t\t\tbase.children?.push(convertNode(child));\n\t\t}\n\t}\n\n\treturn base;\n}\n\nfunction buildScope(ast: ASTNode | null, parent?: Scope): Scope | null {\n\tif (!ast) return null;\n\n\tconst scope: Scope = {\n\t\tparent,\n\t\tsymbols: new Map(),\n\t};\n\n\tif (ast.children) {\n\t\tfor (const child of ast.children) {\n\t\t\tbuildScope(child, scope);\n\t\t}\n\t}\n\n\tast.scope = scope;\n\treturn scope;\n}\n\nfunction collectSymbols(ast: ASTNode | null, uri: string): SymbolInfo[] {\n\tif (!ast) return [];\n\tconst symbols: SymbolInfo[] = [];\n\n\tfunction visit(node: ASTNode) {\n\t\tif (node.type === \"Function\" && node.name) {\n\t\t\tconst symbol: SymbolInfo = {\n\t\t\t\tname: node.name,\n\t\t\t\ttype: \"function\",\n\t\t\t\tdocumentUri: uri,\n\t\t\t\trange: buildRange(node),\n\t\t\t};\n\t\t\tsymbols.push(symbol);\n\t\t\tnode.scope?.symbols.set(node.name, symbol);\n\t\t} else if (node.type === \"Assignment\" && node.name) {\n\t\t\tconst symbol: SymbolInfo = {\n\t\t\t\tname: node.name,\n\t\t\t\ttype: \"variable\",\n\t\t\t\tdocumentUri: uri,\n\t\t\t\trange: buildRange(node),\n\t\t\t};\n\t\t\tsymbols.push(symbol);\n\t\t\tnode.scope?.symbols.set(node.name, symbol);\n\t\t}\n\n\t\tif (node.children) {\n\t\t\tfor (const child of node.children) {\n\t\t\t\tvisit(child);\n\t\t\t}\n\t\t}\n\t}\n\n\tvisit(ast);\n\treturn symbols;\n}\n\nfunction buildRange(node: ASTNode): Range {\n\treturn Range.create(\n\t\tPosition.create(Math.max(node.line - 1, 0), Math.max(node.column, 0)),\n\t\tPosition.create(\n\t\t\tMath.max((node.endLine || node.line) - 1, 0),\n\t\t\tMath.max(node.endColumn || node.column + (node.name?.length || 1), 0),\n\t\t),\n\t);\n}\n\nexport function getWordAtPosition(\n\tdocument: TextDocument,\n\tposition: Position,\n): string | null {\n\tconst line = document.getText({\n\t\tstart: Position.create(position.line, 0),\n\t\tend: Position.create(position.line + 1, 0),\n\t});\n\n\tconst wordRegex = /\\b[a-zA-Z_][a-zA-Z0-9_]*\\b/g;\n\tlet match;\n\twhile ((match = wordRegex.exec(line)) !== null) {\n\t\tconst start = match.index;\n\t\tconst end = start + match[0].length;\n\t\tif (position.character >= start && position.character <= end) {\n\t\t\treturn match[0];\n\t\t}\n\t}\n\n\treturn null;\n}\n\nexport function findSymbolByName(\n\tstate: DocumentState,\n\tname: string,\n): SymbolInfo | null {\n\treturn state.symbols.find((s) => s.name === name) || null;\n}\n","import { TextDocument } from \"vscode-languageserver-textdocument\";\nimport { Diagnostic, DiagnosticSeverity } from \"vscode-languageserver/node\";\nimport { Parser } from \"@l8b/lootiscript/dist/v1/parser\";\nimport { formatForLSP, createDiagnostic } from \"@l8b/diagnostics\";\nimport { Connection } from \"vscode-languageserver/node\";\nimport { LanguageModes, DocumentRegionsCache } from \"./embedded/mode-manager\";\nimport { GLOBAL_API, API_ACCESS_REGEX } from \"./api-definitions/index\";\nimport { getClosestPropertySuggestion } from \"./utils\";\nimport { getDocumentSettings } from \"./settings\";\n\nexport async function validateTextDocument(\n\ttextDocument: TextDocument,\n\tconnection: Connection,\n\thasConfigurationCapability: boolean,\n\tlanguageModes: LanguageModes,\n\tdocumentRegionsCache: DocumentRegionsCache,\n): Promise<void> {\n\tconst settings = await getDocumentSettings(\n\t\tconnection,\n\t\thasConfigurationCapability,\n\t\ttextDocument.uri,\n\t);\n\tif (!settings.diagnostics.enable) {\n\t\tconnection.sendDiagnostics({ uri: textDocument.uri, diagnostics: [] });\n\t\treturn;\n\t}\n\tconst text = textDocument.getText();\n\tconst diagnostics: Diagnostic[] = [];\n\n\t// Validate embedded languages (JSON, etc.) only where they actually exist\n\t// Skips validation for modes with no embedded content to improve performance\n\tconst documentRegions = documentRegionsCache.get(textDocument);\n\tconst allModes = languageModes.getAllModes();\n\tfor (const mode of allModes) {\n\t\tif (mode.doValidation) {\n\t\t\t// Verify this language mode has actual content in the document\n\t\t\tconst embeddedDoc = documentRegions.getEmbeddedDocument(mode.getId());\n\t\t\tconst hasEmbeddedContent = embeddedDoc.getText().trim().length > 0;\n\n\t\t\tif (hasEmbeddedContent) {\n\t\t\t\tconst embeddedDiagnostics = await mode.doValidation(textDocument);\n\t\t\t\tdiagnostics.push(...embeddedDiagnostics);\n\t\t\t}\n\t\t}\n\t}\n\n\t// Validate LootiScript syntax and API usage using the parser\n\t// This is the primary validation layer for .loot files\n\ttry {\n\t\tconst parser = new Parser(text, textDocument.uri);\n\t\tparser.parse();\n\n\t\tif ((parser as any).error_info) {\n\t\t\tconst err = (parser as any).error_info;\n\n\t\t\t// Convert parser error to diagnostic using centralized diagnostics package\n\t\t\tconst diagnosticData = createDiagnostic(err.code || \"E1004\", {\n\t\t\t\tfile: textDocument.uri,\n\t\t\t\tline: err.line,\n\t\t\t\tcolumn: err.column,\n\t\t\t\tlength: err.length,\n\t\t\t\tcontext: err.context,\n\t\t\t\tsuggestions: err.suggestions,\n\t\t\t\trelated: err.related\n\t\t\t\t\t? {\n\t\t\t\t\t\t\tfile: textDocument.uri,\n\t\t\t\t\t\t\tline: err.related.line,\n\t\t\t\t\t\t\tcolumn: err.related.column,\n\t\t\t\t\t\t\tmessage: err.related.message || \"Related location\",\n\t\t\t\t\t\t}\n\t\t\t\t\t: undefined,\n\t\t\t\tdata: {\n\t\t\t\t\terror: err.error,\n\t\t\t\t},\n\t\t\t});\n\n\t\t\t// Convert diagnostic to LSP format for editor integration\n\t\t\tconst lspDiagnostic = formatForLSP(diagnosticData);\n\t\t\tdiagnostics.push(lspDiagnostic as Diagnostic);\n\t\t}\n\t} catch (e: any) {\n\t\tconst diagnostic: Diagnostic = {\n\t\t\tseverity: DiagnosticSeverity.Error,\n\t\t\trange: {\n\t\t\t\tstart: { line: 0, character: 0 },\n\t\t\t\tend: { line: 0, character: 10 },\n\t\t\t},\n\t\t\tmessage: e.message || \"Unknown parser error\",\n\t\t\tsource: \"lootiscript\",\n\t\t};\n\t\tdiagnostics.push(diagnostic);\n\t}\n\n\tvalidateApiUsage(textDocument, diagnostics);\n\n\tconnection.sendDiagnostics({ uri: textDocument.uri, diagnostics });\n}\n\nfunction validateApiUsage(\n\ttextDocument: TextDocument,\n\tdiagnostics: Diagnostic[],\n): void {\n\tconst text = textDocument.getText();\n\tAPI_ACCESS_REGEX.lastIndex = 0;\n\n\tconst seenPositions = new Set<number>();\n\tlet match: RegExpExecArray | null;\n\n\twhile ((match = API_ACCESS_REGEX.exec(text))) {\n\t\tconst matchIndex = match.index;\n\t\tif (seenPositions.has(matchIndex)) {\n\t\t\tcontinue;\n\t\t}\n\t\tseenPositions.add(matchIndex);\n\n\t\tconst fullPath = match[1]; // e.g., \"screen\", \"sprites.player\", \"map.level1\"\n\t\tconst propertyName = match[2]; // e.g., \"drawSprite\", \"invalidProperty\"\n\n\t\t// Extract root object name from property path (e.g., \"sprites\" from \"sprites.player\")\n\t\tconst rootObjectName = fullPath.split(\".\")[0];\n\t\tconst isNested = fullPath.includes(\".\");\n\n\t\t// Runtime collections that are populated dynamically (sprites, maps, etc.)\n\t\t// Cannot validate instance properties statically since they're loaded at runtime\n\t\tconst knownRuntimeObjects = new Set([\n\t\t\t\"sprites\",\n\t\t\t\"map\",\n\t\t\t\"sounds\",\n\t\t\t\"music\",\n\t\t\t\"assets\",\n\t\t]);\n\n\t\t// For nested property access (e.g., sprites.player.x), validate\n\t\t// that the root object exists in the API\n\t\tif (isNested) {\n\t\t\tconst api = GLOBAL_API[rootObjectName];\n\t\t\t// If root object is not a known global API or runtime object,\n\t\t\t// it's likely a user-defined object - skip validation\n\t\t\tif (!api && !knownRuntimeObjects.has(rootObjectName)) {\n\t\t\t\t// Skip validation for user-defined objects\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Report errors for runtime collection property access\n\t\t\t// This helps catch typos but may produce false positives for valid runtime properties\n\t\t\tif (knownRuntimeObjects.has(rootObjectName)) {\n\t\t\t\tconst propertyStart = matchIndex + fullPath.length + 1;\n\t\t\t\tconst startPos = textDocument.positionAt(propertyStart);\n\n\t\t\t\tconst diagnosticData = createDiagnostic(\"E7100\", {\n\t\t\t\t\tfile: textDocument.uri,\n\t\t\t\t\tline: startPos.line + 1,\n\t\t\t\t\tcolumn: startPos.character + 1,\n\t\t\t\t\tlength: propertyName.length,\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tpropertyName,\n\t\t\t\t\t\tobjectName: fullPath,\n\t\t\t\t\t\tsuggestion: undefined,\n\t\t\t\t\t},\n\t\t\t\t});\n\n\t\t\t\tconst lspDiagnostic = formatForLSP(diagnosticData);\n\t\t\t\tdiagnostics.push(lspDiagnostic as Diagnostic);\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\n\t\t// For single-level API access (e.g., screen.drawSprite),\n\t\t// validate property exists in the API definition\n\t\tconst api = GLOBAL_API[fullPath];\n\t\tif (!api || !api.properties) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (api.properties[propertyName]) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tconst prevChar = matchIndex > 0 ? text[matchIndex - 1] : \"\";\n\t\tif (prevChar === '\"' || prevChar === \"'\" || prevChar === \"`\") {\n\t\t\tcontinue;\n\t\t}\n\n\t\tconst propertyStart = matchIndex + fullPath.length + 1;\n\n\t\tconst suggestion = getClosestPropertySuggestion(\n\t\t\tpropertyName,\n\t\t\tObject.keys(api.properties),\n\t\t);\n\n\t\tconst startPos = textDocument.positionAt(propertyStart);\n\n\t\t// Create diagnostic with error code, location, and suggested fix\n\t\tconst diagnosticData = createDiagnostic(\"E7100\", {\n\t\t\tfile: textDocument.uri,\n\t\t\tline: startPos.line + 1, // 1-based\n\t\t\tcolumn: startPos.character + 1, // 1-based\n\t\t\tlength: propertyName.length,\n\t\t\tdata: {\n\t\t\t\tpropertyName,\n\t\t\t\tobjectName: fullPath,\n\t\t\t\tsuggestion,\n\t\t\t},\n\t\t});\n\n\t\t// Convert diagnostic to LSP format for editor integration\n\t\tconst lspDiagnostic = formatForLSP(diagnosticData);\n\t\tdiagnostics.push(lspDiagnostic as Diagnostic);\n\t}\n}\n","import { TextDocument } from \"vscode-languageserver-textdocument\";\nimport { Position } from \"vscode-languageserver/node\";\nimport { CompletionContext } from \"./types\";\n\nexport function getWordAtPosition(\n\tdocument: TextDocument,\n\tposition: Position,\n): string | null {\n\tconst line = document.getText({\n\t\tstart: Position.create(position.line, 0),\n\t\tend: Position.create(position.line, Number.MAX_SAFE_INTEGER),\n\t});\n\tconst regex = /[A-Za-z_][A-Za-z0-9_]*/g;\n\tlet match: RegExpExecArray | null;\n\twhile ((match = regex.exec(line))) {\n\t\tconst start = match.index;\n\t\tconst end = start + match[0].length;\n\t\tif (position.character >= start && position.character <= end) {\n\t\t\treturn match[0];\n\t\t}\n\t}\n\treturn null;\n}\n\nexport function detectCompletionContext(\n\tdocument: TextDocument,\n\tposition: Position,\n): CompletionContext {\n\tconst line = document.getText({\n\t\tstart: Position.create(position.line, 0),\n\t\tend: Position.create(position.line, position.character),\n\t});\n\n\t// Check for property access (e.g., \"screen.\")\n\tconst propertyMatch = line.match(/([A-Za-z_][A-Za-z0-9_]*)\\.\\s*$/);\n\tif (propertyMatch) {\n\t\treturn {\n\t\t\ttype: \"property\",\n\t\t\tobject: propertyMatch[1],\n\t\t};\n\t}\n\n\t// Check if we're in a function call\n\tconst openParenCount = (line.match(/\\(/g) || []).length;\n\tconst closeParenCount = (line.match(/\\)/g) || []).length;\n\tif (openParenCount > closeParenCount) {\n\t\treturn {\n\t\t\ttype: \"function_call\",\n\t\t\tinFunctionCall: true,\n\t\t};\n\t}\n\n\treturn { type: \"default\" };\n}\n\nexport function getClosestPropertySuggestion(\n\ttarget: string,\n\tcandidates: string[],\n): string | null {\n\tif (candidates.length === 0) {\n\t\treturn null;\n\t}\n\n\tlet bestMatch: { value: string; score: number } | null = null;\n\tfor (const candidate of candidates) {\n\t\tconst score = levenshteinDistance(target, candidate);\n\t\tif (!bestMatch || score < bestMatch.score) {\n\t\t\tbestMatch = { value: candidate, score };\n\t\t}\n\t}\n\n\tif (!bestMatch) {\n\t\treturn null;\n\t}\n\n\tconst threshold = Math.max(1, Math.floor(target.length * 0.4));\n\treturn bestMatch.score <= threshold ? bestMatch.value : null;\n}\n\nexport function levenshteinDistance(a: string, b: string): number {\n\tconst rows = a.length + 1;\n\tconst cols = b.length + 1;\n\tconst dp: number[][] = Array.from({ length: rows }, () =>\n\t\tArray(cols).fill(0),\n\t);\n\n\tfor (let i = 0; i < rows; i++) {\n\t\tdp[i][0] = i;\n\t}\n\tfor (let j = 0; j < cols; j++) {\n\t\tdp[0][j] = j;\n\t}\n\n\tfor (let i = 1; i < rows; i++) {\n\t\tfor (let j = 1; j < cols; j++) {\n\t\t\tconst cost = a[i - 1] === b[j - 1] ? 0 : 1;\n\t\t\tdp[i][j] = Math.min(\n\t\t\t\tdp[i - 1][j] + 1,\n\t\t\t\tdp[i][j - 1] + 1,\n\t\t\t\tdp[i - 1][j - 1] + cost,\n\t\t\t);\n\t\t}\n\t}\n\n\treturn dp[a.length][b.length];\n}\n","import { Connection } from \"vscode-languageserver/node\";\nimport { LootiScriptSettings, PartialLootiScriptSettings } from \"./types\";\n\nexport const defaultSettings: LootiScriptSettings = {\n\tdiagnostics: { enable: true },\n\tcompletion: { enable: true },\n\tsignatureHelp: { enable: true },\n\tformat: { enable: true, indentSize: 1 },\n};\n\nlet globalSettings: LootiScriptSettings = defaultSettings;\nconst documentSettings: Map<string, LootiScriptSettings> = new Map();\n\nexport function getGlobalSettings(): LootiScriptSettings {\n\treturn globalSettings;\n}\n\nexport function setGlobalSettings(settings: LootiScriptSettings): void {\n\tglobalSettings = settings;\n}\n\nexport function clearDocumentSettings(): void {\n\tdocumentSettings.clear();\n}\n\nexport function getDocumentSettingsMap(): Map<string, LootiScriptSettings> {\n\treturn documentSettings;\n}\n\nexport async function getDocumentSettings(\n\tconnection: Connection,\n\thasConfigurationCapability: boolean,\n\tresource: string,\n): Promise<LootiScriptSettings> {\n\tif (!hasConfigurationCapability) {\n\t\treturn globalSettings;\n\t}\n\n\tconst cached = documentSettings.get(resource);\n\tif (cached) {\n\t\treturn cached;\n\t}\n\n\tconst configuration = await connection.workspace.getConfiguration({\n\t\tscopeUri: resource,\n\t\tsection: \"lootiscript\",\n\t});\n\tconst sanitized = sanitizeSettings(\n\t\tconfiguration as PartialLootiScriptSettings,\n\t);\n\tdocumentSettings.set(resource, sanitized);\n\treturn sanitized;\n}\n\nexport function sanitizeSettings(\n\tsettings?: PartialLootiScriptSettings,\n): LootiScriptSettings {\n\tconst merged = settings || {};\n\tconst rawIndent =\n\t\tmerged.format?.indentSize ?? defaultSettings.format.indentSize;\n\tconst normalizedIndent = Math.min(Math.max(rawIndent, 1), 4);\n\treturn {\n\t\tdiagnostics: {\n\t\t\tenable: merged.diagnostics?.enable ?? defaultSettings.diagnostics.enable,\n\t\t},\n\t\tcompletion: {\n\t\t\tenable: merged.completion?.enable ?? defaultSettings.completion.enable,\n\t\t},\n\t\tsignatureHelp: {\n\t\t\tenable:\n\t\t\t\tmerged.signatureHelp?.enable ?? defaultSettings.signatureHelp.enable,\n\t\t},\n\t\tformat: {\n\t\t\tenable: merged.format?.enable ?? defaultSettings.format.enable,\n\t\t\tindentSize: normalizedIndent,\n\t\t},\n\t};\n}\n","import {\n\tCompletionItem,\n\tCompletionItemKind,\n\tCompletionList,\n\tInsertTextFormat,\n} from \"vscode-languageserver/node\";\nimport { TextDocument } from \"vscode-languageserver-textdocument\";\nimport { TextDocuments } from \"vscode-languageserver/node\";\nimport { LanguageModes } from \"../embedded/mode-manager\";\nimport { getDocumentStates } from \"../document-state\";\nimport { GLOBAL_API } from \"../api-definitions/index\";\nimport { detectCompletionContext } from \"../utils\";\nimport { getDocumentSettings } from \"../settings\";\nimport { Connection } from \"vscode-languageserver/node\";\n\nexport function setupCompletionHandlers(\n\tconnection: Connection,\n\tdocuments: TextDocuments<TextDocument>,\n\tlanguageModes: LanguageModes,\n\thasConfigurationCapability: boolean,\n) {\n\t// This handler provides the initial list of the completion items.\n\tconnection.onCompletion(\n\t\tasync (params: any): Promise<CompletionItem[] | CompletionList | null> => {\n\t\t\tconst uri = params.textDocument.uri;\n\t\t\tconst document = documents.get(uri);\n\t\t\tif (!document) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst settings = await getDocumentSettings(\n\t\t\t\tconnection,\n\t\t\t\thasConfigurationCapability,\n\t\t\t\turi,\n\t\t\t);\n\t\t\tif (!settings.completion.enable) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst position = params.position;\n\n\t\t\t// Check if we're in an embedded language region\n\t\t\tconst mode = languageModes.getModeAtPosition(document, position);\n\t\t\tif (mode && mode.doComplete) {\n\t\t\t\tconst result = await mode.doComplete(document, position);\n\t\t\t\tif (result) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Detect completion context\n\t\t\tconst context = detectCompletionContext(document, position);\n\n\t\t\t// Property access completion (e.g., screen.drawSprite)\n\t\t\tif (context.type === \"property\" && context.object) {\n\t\t\t\treturn getPropertyCompletions(context.object);\n\t\t\t}\n\n\t\t\t// Default LootiScript completion\n\t\t\tconst documentStates = getDocumentStates();\n\t\t\tconst state = documentStates.get(uri);\n\t\t\tconst items: CompletionItem[] = [];\n\n\t\t\t// Add code snippets (high priority)\n\t\t\titems.push(...getSnippetCompletions());\n\n\t\t\t// Local symbols get highest priority (sortText: \"0\")\n\t\t\t// These are user-defined variables and functions in current scope\n\t\t\tstate?.symbols.forEach((symbol) => {\n\t\t\t\titems.push({\n\t\t\t\t\tlabel: symbol.name,\n\t\t\t\t\tkind:\n\t\t\t\t\t\tsymbol.type === \"function\"\n\t\t\t\t\t\t\t? CompletionItemKind.Function\n\t\t\t\t\t\t\t: CompletionItemKind.Variable,\n\t\t\t\t\tdetail: symbol.type,\n\t\t\t\t\tdata: symbol.name,\n\t\t\t\t\tsortText: `0_${symbol.name}`, // Priority: local symbols\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t// Global APIs get medium priority (sortText: \"1\")\n\t\t\t// Includes screen, audio, keyboard, etc.\n\t\t\tfor (const [name, info] of Object.entries(GLOBAL_API)) {\n\t\t\t\titems.push({\n\t\t\t\t\tlabel: name,\n\t\t\t\t\tkind:\n\t\t\t\t\t\tinfo.type === \"function\"\n\t\t\t\t\t\t\t? CompletionItemKind.Function\n\t\t\t\t\t\t\t: CompletionItemKind.Class,\n\t\t\t\t\tdetail: info.description,\n\t\t\t\t\tdocumentation: info.signature,\n\t\t\t\t\tdata: name,\n\t\t\t\t\tsortText: `1_${name}`, // Priority: globals\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// Keywords get lower priority (sortText: \"2\")\n\t\t\t// Prevents keywords from overshadowing user symbols\n\t\t\t[\n\t\t\t\t\"function\",\n\t\t\t\t\"return\",\n\t\t\t\t\"local\",\n\t\t\t\t\"global\",\n\t\t\t\t\"if\",\n\t\t\t\t\"then\",\n\t\t\t\t\"else\",\n\t\t\t\t\"end\",\n\t\t\t\t\"while\",\n\t\t\t\t\"for\",\n\t\t\t].forEach((keyword) => {\n\t\t\t\titems.push({\n\t\t\t\t\tlabel: keyword,\n\t\t\t\t\tkind: CompletionItemKind.Keyword,\n\t\t\t\t\tdata: keyword,\n\t\t\t\t\tsortText: `2_${keyword}`, // Priority: keywords\n\t\t\t\t});\n\t\t\t});\n\n\t\t\treturn items;\n\t\t},\n\t);\n\n\t// This handler resolves additional information for the item selected in\n\t// the completion list.\n\tconnection.onCompletionResolve((item: CompletionItem): CompletionItem => {\n\t\tconst info = GLOBAL_API[item.data as string];\n\t\tif (info) {\n\t\t\titem.detail = info.signature || info.type;\n\t\t\titem.documentation = info.description;\n\t\t}\n\t\treturn item;\n\t});\n}\n\n/**\n * Get property completions for an object\n */\nfunction getPropertyCompletions(objectName: string): CompletionItem[] {\n\tconst api = GLOBAL_API[objectName];\n\tconst items: CompletionItem[] = [];\n\n\tif (api && api.properties) {\n\t\tfor (const [propName, propInfo] of Object.entries(api.properties)) {\n\t\t\titems.push({\n\t\t\t\tlabel: propName,\n\t\t\t\tkind:\n\t\t\t\t\tpropInfo.type === \"method\"\n\t\t\t\t\t\t? CompletionItemKind.Method\n\t\t\t\t\t\t: CompletionItemKind.Property,\n\t\t\t\tdetail: propInfo.description,\n\t\t\t\tdocumentation: propInfo.signature,\n\t\t\t\tinsertText: propInfo.type === \"method\" ? `${propName}($0)` : propName,\n\t\t\t\tinsertTextFormat:\n\t\t\t\t\tpropInfo.type === \"method\"\n\t\t\t\t\t\t? InsertTextFormat.Snippet\n\t\t\t\t\t\t: InsertTextFormat.PlainText,\n\t\t\t});\n\t\t}\n\t}\n\n\treturn items;\n}\n\n/**\n * Get code snippet completions\n */\nfunction getSnippetCompletions(): CompletionItem[] {\n\treturn [\n\t\t{\n\t\t\tlabel: \"func\",\n\t\t\tkind: CompletionItemKind.Snippet,\n\t\t\tdetail: \"Function definition\",\n\t\t\tinsertText: \"${1:name} = function(${2:args})\\n\\t${3:// body}\\nend\",\n\t\t\tinsertTextFormat: InsertTextFormat.Snippet,\n\t\t\tdocumentation: \"Creates a new function\",\n\t\t},\n\t\t{\n\t\t\tlabel: \"update\",\n\t\t\tkind: CompletionItemKind.Snippet,\n\t\t\tdetail: \"Update loop function\",\n\t\t\tinsertText: \"update = function()\\n\\t${1:// update logic}\\nend\",\n\t\t\tinsertTextFormat: InsertTextFormat.Snippet,\n\t\t\tdocumentation: \"Game update loop function\",\n\t\t},\n\t\t{\n\t\t\tlabel: \"draw\",\n\t\t\tkind: CompletionItemKind.Snippet,\n\t\t\tdetail: \"Draw loop function\",\n\t\t\tinsertText: \"draw = function()\\n\\t${1:// draw logic}\\nend\",\n\t\t\tinsertTextFormat: InsertTextFormat.Snippet,\n\t\t\tdocumentation: \"Game draw loop function\",\n\t\t},\n\t\t{\n\t\t\tlabel: \"if\",\n\t\t\tkind: CompletionItemKind.Snippet,\n\t\t\tdetail: \"If statement\",\n\t\t\tinsertText: \"if ${1:condition} then\\n\\t${2:// code}\\nend\",\n\t\t\tinsertTextFormat: InsertTextFormat.Snippet,\n\t\t\tdocumentation: \"If conditional statement\",\n\t\t},\n\t\t{\n\t\t\tlabel: \"ifelse\",\n\t\t\tkind: CompletionItemKind.Snippet,\n\t\t\tdetail: \"If-else statement\",\n\t\t\tinsertText:\n\t\t\t\t\"if ${1:condition} then\\n\\t${2:// true}\\nelse\\n\\t${3:// false}\\nend\",\n\t\t\tinsertTextFormat: InsertTextFormat.Snippet,\n\t\t\tdocumentation: \"If-else conditional statement\",\n\t\t},\n\t\t{\n\t\t\tlabel: \"for\",\n\t\t\tkind: CompletionItemKind.Snippet,\n\t\t\tdetail: \"For loop\",\n\t\t\tinsertText: \"for ${1:i} in ${2:list} do\\n\\t${3:// code}\\nend\",\n\t\t\tinsertTextFormat: InsertTextFormat.Snippet,\n\t\t\tdocumentation: \"For loop iteration\",\n\t\t},\n\t\t{\n\t\t\tlabel: \"while\",\n\t\t\tkind: CompletionItemKind.Snippet,\n\t\t\tdetail: \"While loop\",\n\t\t\tinsertText: \"while ${1:condition} do\\n\\t${2:// code}\\nend\",\n\t\t\tinsertTextFormat: InsertTextFormat.Snippet,\n\t\t\tdocumentation: \"While loop\",\n\t\t},\n\t];\n}\n","import { Hover } from \"vscode-languageserver/node\";\nimport { TextDocument } from \"vscode-languageserver-textdocument\";\nimport { TextDocuments } from \"vscode-languageserver/node\";\nimport { HoverParams } from \"vscode-languageserver-protocol\";\nimport { LanguageModes } from \"../embedded/mode-manager\";\nimport { getDocumentStates } from \"../document-state\";\nimport { GLOBAL_API } from \"../api-definitions/index\";\nimport { getWordAtPosition } from \"../utils\";\nimport { SymbolInfo } from \"../types\";\n\nexport function setupHoverHandler(\n\tconnection: any,\n\tdocuments: TextDocuments<TextDocument>,\n\tlanguageModes: LanguageModes,\n) {\n\tconnection.onHover(async (params: HoverParams): Promise<Hover | null> => {\n\t\tconst document = documents.get(params.textDocument.uri);\n\t\tif (!document) return null;\n\n\t\t// Check if we're in an embedded language region\n\t\ttry {\n\t\t\tconst mode = languageModes.getModeAtPosition(document, params.position);\n\t\t\tif (mode && mode.doHover) {\n\t\t\t\tconst result = await mode.doHover(document, params.position);\n\t\t\t\tif (result) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t}\n\t\t} catch (error: any) {\n\t\t\t// Log error but continue with default hover\n\t\t\tconnection.console?.error(\n\t\t\t\t`Hover error in embedded mode: ${error?.message || error}`,\n\t\t\t);\n\t\t}\n\n\t\t// Default LootiScript hover\n\t\tconst documentStates = getDocumentStates();\n\t\tconst state = documentStates.get(params.textDocument.uri);\n\t\tif (!state) return null;\n\t\tconst word = getWordAtPosition(state.textDocument, params.position);\n\t\tif (!word) return null;\n\n\t\tconst symbol = findSymbolByName(state, word);\n\t\tif (symbol) {\n\t\t\treturn {\n\t\t\t\tcontents: {\n\t\t\t\t\tkind: \"markdown\",\n\t\t\t\t\tvalue: `**${symbol.name}** (${symbol.type})`,\n\t\t\t\t},\n\t\t\t};\n\t\t}\n\n\t\tconst globalInfo = GLOBAL_API[word];\n\t\tif (globalInfo) {\n\t\t\treturn {\n\t\t\t\tcontents: {\n\t\t\t\t\tkind: \"markdown\",\n\t\t\t\t\tvalue: `**${word}** - ${globalInfo.description}\\n\\n${globalInfo.signature || \"\"}`,\n\t\t\t\t},\n\t\t\t};\n\t\t}\n\n\t\treturn null;\n\t});\n}\n\nfunction findSymbolByName(\n\tstate: { symbols: SymbolInfo[] },\n\tname: string,\n): SymbolInfo | undefined {\n\treturn state.symbols.find((sym) => sym.name === name);\n}\n","import {\n\tSignatureHelp,\n\tSignatureInformation,\n\tParameterInformation,\n\tPosition,\n} from \"vscode-languageserver/node\";\nimport { TextDocument } from \"vscode-languageserver-textdocument\";\nimport { TextDocuments } from \"vscode-languageserver/node\";\nimport { GLOBAL_API } from \"../api-definitions/index\";\nimport { getDocumentSettings } from \"../settings\";\nimport { Connection } from \"vscode-languageserver/node\";\n\nexport function setupSignatureHelpHandler(\n\tconnection: Connection,\n\tdocuments: TextDocuments<TextDocument>,\n\thasConfigurationCapability: boolean,\n) {\n\t// Signature help provides parameter information when typing function calls\n\tconnection.onSignatureHelp(async (params): Promise<SignatureHelp | null> => {\n\t\tconst document = documents.get(params.textDocument.uri);\n\t\tif (!document) return null;\n\n\t\tconst settings = await getDocumentSettings(\n\t\t\tconnection,\n\t\t\thasConfigurationCapability,\n\t\t\tparams.textDocument.uri,\n\t\t);\n\t\tif (!settings.signatureHelp.enable) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst line = document.getText({\n\t\t\tstart: Position.create(params.position.line, 0),\n\t\t\tend: Position.create(params.position.line, params.position.character),\n\t\t});\n\n\t\t// Extract function name from the line\n\t\tconst functionMatch = line.match(/([A-Za-z_][A-Za-z0-9_.]*)\\s*\\([^)]*$/);\n\t\tif (!functionMatch) return null;\n\n\t\tconst functionName = functionMatch[1];\n\n\t\t// Check if it's a method call (e.g., screen.drawSprite)\n\t\tconst parts = functionName.split(\".\");\n\t\tlet signature: string | undefined;\n\t\tlet description: string | undefined;\n\n\t\tif (parts.length === 2) {\n\t\t\t// Property method call\n\t\t\tconst [objectName, methodName] = parts;\n\t\t\tconst api = GLOBAL_API[objectName];\n\t\t\tif (api && api.properties && api.properties[methodName]) {\n\t\t\t\tsignature = api.properties[methodName].signature;\n\t\t\t\tdescription = api.properties[methodName].description;\n\t\t\t}\n\t\t} else {\n\t\t\t// Global function call\n\t\t\tconst api = GLOBAL_API[functionName];\n\t\t\tif (api) {\n\t\t\t\tsignature = api.signature;\n\t\t\t\tdescription = api.description;\n\t\t\t}\n\t\t}\n\n\t\tif (!signature) return null;\n\n\t\t// Parse signature to extract parameters\n\t\tconst paramMatch = signature.match(/\\(([^)]*)\\)/);\n\t\tconst paramsStr = paramMatch ? paramMatch[1] : \"\";\n\t\tconst parameters: ParameterInformation[] = paramsStr\n\t\t\t.split(\",\")\n\t\t\t.filter((p) => p.trim())\n\t\t\t.map((param) => ({\n\t\t\t\tlabel: param.trim(),\n\t\t\t}));\n\n\t\t// Count commas to determine active parameter\n\t\tconst commaCount = (line.match(/,/g) || []).length;\n\t\tconst activeParameter = Math.min(commaCount, parameters.length - 1);\n\n\t\treturn {\n\t\t\tsignatures: [\n\t\t\t\tSignatureInformation.create(signature, description, ...parameters),\n\t\t\t],\n\t\t\tactiveSignature: 0,\n\t\t\tactiveParameter: activeParameter >= 0 ? activeParameter : 0,\n\t\t};\n\t});\n}\n","import {\n\tLocation,\n\tSymbolInformation,\n\tSymbolKind,\n\tDefinitionParams,\n\tDocumentSymbolParams,\n\tRenameParams,\n\tWorkspaceEdit,\n\tTextEdit,\n\tReferenceParams,\n} from \"vscode-languageserver/node\";\nimport { getDocumentStates } from \"../document-state\";\nimport { getWordAtPosition } from \"../utils\";\nimport { SymbolInfo } from \"../types\";\n\nexport function setupSymbolHandlers(connection: any) {\n\tconnection.onDefinition((params: DefinitionParams) => {\n\t\tconst documentStates = getDocumentStates();\n\t\tconst state = documentStates.get(params.textDocument.uri);\n\t\tif (!state) return [];\n\t\tconst word = getWordAtPosition(state.textDocument, params.position);\n\t\tif (!word) return [];\n\t\tconst symbol = findSymbolByName(state, word);\n\t\tif (!symbol) return [];\n\t\treturn Location.create(symbol.documentUri, symbol.range);\n\t});\n\n\tconnection.onDocumentSymbol((params: DocumentSymbolParams) => {\n\t\tconst documentStates = getDocumentStates();\n\t\tconst state = documentStates.get(params.textDocument.uri);\n\t\tif (!state) return [];\n\t\treturn state.symbols.map((symbol) => ({\n\t\t\tname: symbol.name,\n\t\t\tkind:\n\t\t\t\tsymbol.type === \"function\" ? SymbolKind.Function : SymbolKind.Variable,\n\t\t\tlocation: Location.create(symbol.documentUri, symbol.range),\n\t\t}));\n\t});\n\n\tconnection.onWorkspaceSymbol(() => {\n\t\tconst documentStates = getDocumentStates();\n\t\tconst infos: SymbolInformation[] = [];\n\t\tfor (const state of documentStates.values()) {\n\t\t\tstate.symbols.forEach((symbol) => {\n\t\t\t\tinfos.push({\n\t\t\t\t\tname: symbol.name,\n\t\t\t\t\tkind:\n\t\t\t\t\t\tsymbol.type === \"function\"\n\t\t\t\t\t\t\t? SymbolKind.Function\n\t\t\t\t\t\t\t: SymbolKind.Variable,\n\t\t\t\t\tlocation: Location.create(symbol.documentUri, symbol.range),\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\treturn infos;\n\t});\n\n\t// Find all references to a symbol across the workspace\n\tconnection.onReferences((params: ReferenceParams) => {\n\t\tconst documentStates = getDocumentStates();\n\t\tconst state = documentStates.get(params.textDocument.uri);\n\t\tif (!state) return [];\n\n\t\tconst word = getWordAtPosition(state.textDocument, params.position);\n\t\tif (!word) return [];\n\n\t\tconst references: Location[] = [];\n\n\t\t// Search across all open documents in the workspace\n\t\tfor (const [uri, docState] of documentStates) {\n\t\t\tconst text = docState.textDocument.getText();\n\t\t\tconst regex = new RegExp(`\\\\b${word}\\\\b`, \"g\");\n\t\t\tlet match;\n\n\t\t\twhile ((match = regex.exec(text))) {\n\t\t\t\tconst start = docState.textDocument.positionAt(match.index);\n\t\t\t\tconst end = docState.textDocument.positionAt(match.index + word.length);\n\t\t\t\treferences.push(\n\t\t\t\t\tLocation.create(uri, {\n\t\t\t\t\t\tstart,\n\t\t\t\t\t\tend,\n\t\t\t\t\t}),\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\treturn references;\n\t});\n\n\tconnection.onRenameRequest((params: RenameParams): WorkspaceEdit | null => {\n\t\tconst documentStates = getDocumentStates();\n\t\tconst state = documentStates.get(params.textDocument.uri);\n\t\tif (!state) return null;\n\t\tconst word = getWordAtPosition(state.textDocument, params.position);\n\t\tif (!word) return null;\n\t\tconst edits: TextEdit[] = [];\n\t\tconst text = state.textDocument.getText();\n\t\tconst regex = new RegExp(`\\\\b${word}\\\\b`, \"g\");\n\t\tlet match;\n\t\twhile ((match = regex.exec(text))) {\n\t\t\tconst start = state.textDocument.positionAt(match.index);\n\t\t\tconst end = state.textDocument.positionAt(match.index + word.length);\n\t\t\tedits.push({\n\t\t\t\trange: { start, end },\n\t\t\t\tnewText: params.newName,\n\t\t\t});\n\t\t}\n\t\treturn {\n\t\t\tchanges: {\n\t\t\t\t[params.textDocument.uri]: edits,\n\t\t\t},\n\t\t};\n\t});\n}\n\nfunction findSymbolByName(\n\tstate: { symbols: SymbolInfo[] },\n\tname: string,\n): SymbolInfo | undefined {\n\treturn state.symbols.find((sym) => sym.name === name);\n}\n","import {\n\tDocumentFormattingParams,\n\tTextEdit,\n\tRange,\n\tPosition,\n} from \"vscode-languageserver/node\";\nimport { TextDocument } from \"vscode-languageserver-textdocument\";\nimport { TextDocuments } from \"vscode-languageserver/node\";\nimport { getDocumentSettings } from \"../settings\";\nimport { Connection } from \"vscode-languageserver/node\";\n\nexport function setupFormattingHandler(\n\tconnection: Connection,\n\tdocuments: TextDocuments<TextDocument>,\n\thasConfigurationCapability: boolean,\n) {\n\tconnection.onDocumentFormatting(async (params: DocumentFormattingParams) => {\n\t\tconst doc = documents.get(params.textDocument.uri);\n\t\tif (!doc) return [];\n\t\tconst settings = await getDocumentSettings(\n\t\t\tconnection,\n\t\t\thasConfigurationCapability,\n\t\t\tparams.textDocument.uri,\n\t\t);\n\t\tif (!settings.format.enable) {\n\t\t\treturn [];\n\t\t}\n\t\tconst text = doc.getText();\n\t\tconst lines = text.split(/\\r?\\n/);\n\t\tconst indentWidth = Math.max(settings.format.indentSize, 1);\n\t\tconst indentUnit = params.options.insertSpaces\n\t\t\t? \" \".repeat(indentWidth)\n\t\t\t: \"\t\".repeat(indentWidth);\n\t\tlet indent = 0;\n\t\tconst formatted = lines.map((line) => {\n\t\t\tlet trimmed = line.trim();\n\t\t\tif (/^(end|else|elseif)/.test(trimmed)) {\n\t\t\t\tindent = Math.max(indent - 1, 0);\n\t\t\t}\n\t\t\tconst formattedLine = `${indentUnit.repeat(indent)}${trimmed}`;\n\t\t\tif (\n\t\t\t\t/(then|do|function|repeat)\\b.*$/.test(trimmed) &&\n\t\t\t\t!trimmed.includes(\"end\")\n\t\t\t) {\n\t\t\t\tindent++;\n\t\t\t}\n\t\t\treturn formattedLine;\n\t\t});\n\t\tconst fullRange = Range.create(\n\t\t\tPosition.create(0, 0),\n\t\t\tdoc.positionAt(text.length),\n\t\t);\n\t\treturn [TextEdit.replace(fullRange, formatted.join(\"\\n\"))];\n\t});\n}\n","import {\n\tCodeActionParams,\n\tCodeAction,\n\tCodeActionKind,\n\tTextEdit,\n\tPosition,\n} from \"vscode-languageserver/node\";\nimport { TextDocument } from \"vscode-languageserver-textdocument\";\nimport { TextDocuments } from \"vscode-languageserver/node\";\nimport { getWordAtPosition } from \"../utils\";\n\nexport function setupCodeActionsHandler(\n\tconnection: any,\n\tdocuments: TextDocuments<TextDocument>,\n) {\n\tconnection.onCodeAction((params: CodeActionParams): CodeAction[] => {\n\t\tconst actions: CodeAction[] = [];\n\n\t\tfor (const diagnostic of params.context.diagnostics) {\n\t\t\tconst message = diagnostic.message.toLowerCase();\n\t\t\tconst errorCode = diagnostic.code as string | undefined;\n\n\t\t\t// Quick fix for unterminated blocks (E1001, E1003)\n\t\t\t// Automatically inserts missing 'end' statement at appropriate location\n\t\t\tif (errorCode === \"E1001\" || errorCode === \"E1003\") {\n\t\t\t\tconst document = documents.get(params.textDocument.uri);\n\t\t\t\tif (document) {\n\t\t\t\t\tconst errorLine = diagnostic.range.end.line;\n\n\t\t\t\t\t// Find appropriate insertion point - skip empty lines and existing 'end' statements\n\t\t\t\t\tlet insertLine = errorLine + 1;\n\t\t\t\t\twhile (insertLine < document.lineCount) {\n\t\t\t\t\t\tconst nextLine = document.getText({\n\t\t\t\t\t\t\tstart: { line: insertLine, character: 0 },\n\t\t\t\t\t\t\tend: { line: insertLine, character: Number.MAX_SAFE_INTEGER },\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (nextLine.trim() && !nextLine.trim().startsWith(\"end\")) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tinsertLine++;\n\t\t\t\t\t}\n\n\t\t\t\t\tactions.push({\n\t\t\t\t\t\ttitle: \"Add missing 'end' to close block\",\n\t\t\t\t\t\tkind: CodeActionKind.QuickFix,\n\t\t\t\t\t\tedit: {\n\t\t\t\t\t\t\tchanges: {\n\t\t\t\t\t\t\t\t[params.textDocument.uri]: [\n\t\t\t\t\t\t\t\t\tTextEdit.insert(Position.create(insertLine, 0), \"end\\n\"),\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\tdiagnostics: [diagnostic],\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Quick fix for extra 'end' statements (E1002)\n\t\t\t// Simply removes the redundant 'end' keyword\n\t\t\tif (errorCode === \"E1002\" || message.includes(\"too many 'end'\")) {\n\t\t\t\tactions.push({\n\t\t\t\t\ttitle: \"Remove extra 'end' statement\",\n\t\t\t\t\tkind: CodeActionKind.QuickFix,\n\t\t\t\t\tedit: {\n\t\t\t\t\t\tchanges: {\n\t\t\t\t\t\t\t[params.textDocument.uri]: [\n\t\t\t\t\t\t\t\tTextEdit.replace(diagnostic.range, \"\"),\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tdiagnostics: [diagnostic],\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// Generic quick fix for unterminated blocks without specific error code\n\t\t\t// Fallback for parsers that don't provide detailed error codes\n\t\t\tif (\n\t\t\t\t(message.includes(\"unterminated\") ||\n\t\t\t\t\tmessage.includes(\"missing 'end'\")) &&\n\t\t\t\t!errorCode\n\t\t\t) {\n\t\t\t\tactions.push({\n\t\t\t\t\ttitle: \"Insert 'end'\",\n\t\t\t\t\tkind: CodeActionKind.QuickFix,\n\t\t\t\t\tedit: {\n\t\t\t\t\t\tchanges: {\n\t\t\t\t\t\t\t[params.textDocument.uri]: [\n\t\t\t\t\t\t\t\tTextEdit.insert(\n\t\t\t\t\t\t\t\t\tPosition.create(diagnostic.range.end.line + 1, 0),\n\t\t\t\t\t\t\t\t\t\"end\\n\",\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tdiagnostics: [diagnostic],\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// Quick fix for undefined variables\n\t\t\t// Suggests declaring the variable with 'local' keyword\n\t\t\tif (message.includes(\"undefined\") || message.includes(\"not defined\")) {\n\t\t\t\tconst document = documents.get(params.textDocument.uri);\n\t\t\t\tif (document) {\n\t\t\t\t\tconst word = getWordAtPosition(document, diagnostic.range.start);\n\t\t\t\t\tif (word) {\n\t\t\t\t\t\tactions.push({\n\t\t\t\t\t\t\ttitle: `Declare variable '${word}'`,\n\t\t\t\t\t\t\tkind: CodeActionKind.QuickFix,\n\t\t\t\t\t\t\tedit: {\n\t\t\t\t\t\t\t\tchanges: {\n\t\t\t\t\t\t\t\t\t[params.textDocument.uri]: [\n\t\t\t\t\t\t\t\t\t\tTextEdit.insert(\n\t\t\t\t\t\t\t\t\t\t\tPosition.create(diagnostic.range.start.line, 0),\n\t\t\t\t\t\t\t\t\t\t\t`local ${word} = nil\\n`,\n\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tdiagnostics: [diagnostic],\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Refactor action: Extract to function (if there's a selection)\n\t\tif (\n\t\t\tparams.range &&\n\t\t\t(params.range.start.line !== params.range.end.line ||\n\t\t\t\tparams.range.start.character !== params.range.end.character)\n\t\t) {\n\t\t\tconst document = documents.get(params.textDocument.uri);\n\t\t\tif (document) {\n\t\t\t\tconst selectedText = document.getText(params.range);\n\t\t\t\tif (selectedText.trim()) {\n\t\t\t\t\tactions.push({\n\t\t\t\t\t\ttitle: \"Extract to function\",\n\t\t\t\t\t\tkind: CodeActionKind.RefactorExtract,\n\t\t\t\t\t\tedit: {\n\t\t\t\t\t\t\tchanges: {\n\t\t\t\t\t\t\t\t[params.textDocument.uri]: [\n\t\t\t\t\t\t\t\t\t// Replace selection with function call\n\t\t\t\t\t\t\t\t\tTextEdit.replace(params.range, \"extracted_function()\"),\n\t\t\t\t\t\t\t\t\t// Insert function definition at end\n\t\t\t\t\t\t\t\t\tTextEdit.insert(\n\t\t\t\t\t\t\t\t\t\tPosition.create(document.lineCount, 0),\n\t\t\t\t\t\t\t\t\t\t`\\n\\nextracted_function = function()\\n\\t${selectedText.replace(/\\n/g, \"\\n\\t\")}\\nend\\n`,\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn actions;\n\t});\n}\n","import { Definition, Location } from \"vscode-languageserver/node\";\nimport { TextDocument } from \"vscode-languageserver-textdocument\";\nimport { TextDocuments, Connection } from \"vscode-languageserver/node\";\nimport { getDocumentStates, getWordAtPosition } from \"../document-state\";\n\nexport function setupDefinitionHandler(\n\tconnection: Connection,\n\tdocuments: TextDocuments<TextDocument>,\n) {\n\tconnection.onDefinition((params): Definition | null => {\n\t\tconst document = documents.get(params.textDocument.uri);\n\t\tif (!document) return null;\n\n\t\tconst documentStates = getDocumentStates();\n\t\tconst state = documentStates.get(params.textDocument.uri);\n\t\tif (!state) return null;\n\n\t\tconst word = getWordAtPosition(document, params.position);\n\t\tif (!word) return null;\n\n\t\t// Find symbol definition\n\t\tfor (const symbol of state.symbols) {\n\t\t\tif (symbol.name === word) {\n\t\t\t\treturn Location.create(params.textDocument.uri, symbol.range);\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t});\n}\n","import { Location, Position, Range } from \"vscode-languageserver/node\";\nimport { TextDocument } from \"vscode-languageserver-textdocument\";\nimport { TextDocuments, Connection } from \"vscode-languageserver/node\";\nimport { getDocumentStates, getWordAtPosition } from \"../document-state\";\n\nexport function setupReferencesHandler(\n\tconnection: Connection,\n\tdocuments: TextDocuments<TextDocument>,\n) {\n\tconnection.onReferences((params): Location[] | null => {\n\t\tconst document = documents.get(params.textDocument.uri);\n\t\tif (!document) return null;\n\n\t\tconst documentStates = getDocumentStates();\n\t\tconst state = documentStates.get(params.textDocument.uri);\n\t\tif (!state) return null;\n\n\t\tconst word = getWordAtPosition(document, params.position);\n\t\tif (!word) return null;\n\n\t\tconst locations: Location[] = [];\n\t\tconst text = document.getText();\n\t\tconst lines = text.split(\"\\n\");\n\n\t\t// Find all occurrences of the word\n\t\tconst wordRegex = new RegExp(`\\\\b${word}\\\\b`, \"g\");\n\t\tlines.forEach((line, lineIndex) => {\n\t\t\tlet match;\n\t\t\twhile ((match = wordRegex.exec(line)) !== null) {\n\t\t\t\tlocations.push(\n\t\t\t\t\tLocation.create(\n\t\t\t\t\t\tparams.textDocument.uri,\n\t\t\t\t\t\tRange.create(\n\t\t\t\t\t\t\tPosition.create(lineIndex, match.index),\n\t\t\t\t\t\t\tPosition.create(lineIndex, match.index + word.length),\n\t\t\t\t\t\t),\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t}\n\t\t});\n\n\t\treturn locations.length > 0 ? locations : null;\n\t});\n}\n","import {\n\tPrepareRenameParams,\n\tRange,\n\tRenameParams,\n\tWorkspaceEdit,\n\tTextEdit,\n\tPosition,\n} from \"vscode-languageserver/node\";\nimport { TextDocument } from \"vscode-languageserver-textdocument\";\nimport { TextDocuments, Connection } from \"vscode-languageserver/node\";\nimport { getWordAtPosition } from \"../document-state\";\n\n// Reserved keywords that cannot be used as identifiers\nconst RESERVED_KEYWORDS = [\n\t\"function\",\n\t\"end\",\n\t\"if\",\n\t\"then\",\n\t\"else\",\n\t\"elsif\",\n\t\"for\",\n\t\"to\",\n\t\"by\",\n\t\"in\",\n\t\"while\",\n\t\"do\",\n\t\"return\",\n\t\"break\",\n\t\"continue\",\n\t\"local\",\n\t\"var\",\n\t\"let\",\n\t\"and\",\n\t\"or\",\n\t\"not\",\n\t\"true\",\n\t\"false\",\n\t\"null\",\n\t\"object\",\n\t\"class\",\n\t\"extends\",\n\t\"new\",\n\t\"delete\",\n\t\"after\",\n\t\"every\",\n\t\"sleep\",\n];\n\n// Global API names that should not be renamed\nconst API_RESERVED = [\n\t\"screen\",\n\t\"audio\",\n\t\"keyboard\",\n\t\"mouse\",\n\t\"touch\",\n\t\"gamepad\",\n\t\"sprites\",\n\t\"maps\",\n\t\"sounds\",\n\t\"music\",\n\t\"assets\",\n\t\"system\",\n\t\"storage\",\n\t\"scene\",\n\t\"route\",\n\t\"router\",\n\t\"print\",\n\t\"List\",\n\t\"Math\",\n\t\"String\",\n\t\"JSON\",\n\t\"Random\",\n\t\"ObjectPool\",\n\t\"Image\",\n\t\"Sprite\",\n\t\"Map\",\n\t\"Sound\",\n];\n\nexport function setupRenameHandler(\n\tconnection: Connection,\n\tdocuments: TextDocuments<TextDocument>,\n) {\n\t// Prepare rename - validate if symbol can be renamed\n\tconnection.onPrepareRename(\n\t\t(\n\t\t\tparams: PrepareRenameParams,\n\t\t): Range | { range: Range; placeholder: string } | null => {\n\t\t\tconst document = documents.get(params.textDocument.uri);\n\t\t\tif (!document) return null;\n\n\t\t\tconst word = getWordAtPosition(document, params.position);\n\t\t\tif (!word) return null;\n\n\t\t\t// Check if it's a reserved keyword or API name\n\t\t\tif (RESERVED_KEYWORDS.includes(word) || API_RESERVED.includes(word)) {\n\t\t\t\treturn null; // Cannot rename reserved words\n\t\t\t}\n\n\t\t\t// Return range and placeholder\n\t\t\tconst line = document.getText({\n\t\t\t\tstart: Position.create(params.position.line, 0),\n\t\t\t\tend: Position.create(params.position.line + 1, 0),\n\t\t\t});\n\n\t\t\tconst wordIndex = line.indexOf(word);\n\t\t\tif (wordIndex === -1) return null;\n\n\t\t\treturn {\n\t\t\t\trange: Range.create(\n\t\t\t\t\tPosition.create(params.position.line, wordIndex),\n\t\t\t\t\tPosition.create(params.position.line, wordIndex + word.length),\n\t\t\t\t),\n\t\t\t\tplaceholder: word,\n\t\t\t};\n\t\t},\n\t);\n\n\t// Perform rename\n\tconnection.onRenameRequest((params: RenameParams): WorkspaceEdit | null => {\n\t\tconst document = documents.get(params.textDocument.uri);\n\t\tif (!document) return null;\n\n\t\tconst word = getWordAtPosition(document, params.position);\n\t\tif (!word) return null;\n\n\t\tconst newName = params.newName;\n\n\t\t// Validate new name\n\t\tif (RESERVED_KEYWORDS.includes(newName) || API_RESERVED.includes(newName)) {\n\t\t\treturn null; // Cannot use reserved words as new name\n\t\t}\n\n\t\t// Find all occurrences and create edits\n\t\tconst edits: TextEdit[] = [];\n\t\tconst text = document.getText();\n\t\tconst lines = text.split(\"\\n\");\n\t\tconst wordRegex = new RegExp(`\\\\b${word}\\\\b`, \"g\");\n\n\t\tlines.forEach((line, lineIndex) => {\n\t\t\tlet match;\n\t\t\twhile ((match = wordRegex.exec(line)) !== null) {\n\t\t\t\tedits.push(\n\t\t\t\t\tTextEdit.replace(\n\t\t\t\t\t\tRange.create(\n\t\t\t\t\t\t\tPosition.create(lineIndex, match.index),\n\t\t\t\t\t\t\tPosition.create(lineIndex, match.index + word.length),\n\t\t\t\t\t\t),\n\t\t\t\t\t\tnewName,\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t}\n\t\t});\n\n\t\treturn {\n\t\t\tchanges: {\n\t\t\t\t[params.textDocument.uri]: edits,\n\t\t\t},\n\t\t};\n\t});\n}\n","import {\n\tSemanticTokensBuilder,\n\tSemanticTokensParams,\n\tSemanticTokens,\n} from \"vscode-languageserver/node\";\nimport { TextDocument } from \"vscode-languageserver-textdocument\";\nimport { TextDocuments, Connection } from \"vscode-languageserver/node\";\n\n// Token types (must match client configuration)\nexport const TOKEN_TYPES = [\n\t\"namespace\", // 0 - API objects (screen, audio, etc)\n\t\"class\", // 1 - Constructors (Random, ObjectPool, etc)\n\t\"function\", // 2 - Functions\n\t\"variable\", // 3 - Variables\n\t\"parameter\", // 4 - Function parameters\n\t\"property\", // 5 - Object properties\n\t\"keyword\", // 6 - Reserved keywords\n\t\"number\", // 7 - Numbers\n\t\"string\", // 8 - Strings\n\t\"comment\", // 9 - Comments\n];\n\n// Token modifiers\nexport const TOKEN_MODIFIERS = [\n\t\"declaration\", // 0\n\t\"readonly\", // 1\n\t\"static\", // 2\n\t\"deprecated\", // 3\n\t\"modification\", // 4\n\t\"documentation\", // 5\n\t\"defaultLibrary\", // 6 - Built-in/standard library\n];\n\n// API objects for semantic highlighting\nconst API_OBJECTS = [\n\t\"screen\",\n\t\"audio\",\n\t\"keyboard\",\n\t\"mouse\",\n\t\"touch\",\n\t\"gamepad\",\n\t\"sprites\",\n\t\"maps\",\n\t\"sounds\",\n\t\"music\",\n\t\"assets\",\n\t\"system\",\n\t\"storage\",\n\t\"router\",\n];\n\nconst CONSTRUCTORS = [\n\t\"Random\",\n\t\"ObjectPool\",\n\t\"Image\",\n\t\"Sprite\",\n\t\"Map\",\n\t\"Sound\",\n\t\"List\",\n\t\"Math\",\n\t\"String\",\n\t\"JSON\",\n];\n\nexport function setupSemanticTokensHandler(\n\tconnection: Connection,\n\tdocuments: TextDocuments<TextDocument>,\n) {\n\tconnection.languages.semanticTokens.on(\n\t\t(params: SemanticTokensParams): SemanticTokens => {\n\t\t\tconst document = documents.get(params.textDocument.uri);\n\t\t\tif (!document) {\n\t\t\t\treturn { data: [] };\n\t\t\t}\n\n\t\t\tconst builder = new SemanticTokensBuilder();\n\t\t\tconst text = document.getText();\n\t\t\tconst lines = text.split(\"\\n\");\n\n\t\t\tlines.forEach((line, lineIndex) => {\n\t\t\t\t// Highlight API objects (screen, audio, etc.) as namespaces with defaultLibrary modifier\n\t\t\t\tAPI_OBJECTS.forEach((api) => {\n\t\t\t\t\tconst regex = new RegExp(`\\\\b${api}\\\\b`, \"g\");\n\t\t\t\t\tlet match;\n\t\t\t\t\twhile ((match = regex.exec(line)) !== null) {\n\t\t\t\t\t\tbuilder.push(\n\t\t\t\t\t\t\tlineIndex,\n\t\t\t\t\t\t\tmatch.index,\n\t\t\t\t\t\t\tapi.length,\n\t\t\t\t\t\t\t0, // namespace token type\n\t\t\t\t\t\t\t1 << 6, // defaultLibrary modifier\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// Highlight constructors (Random, ObjectPool, etc.) as classes with defaultLibrary modifier\n\t\t\t\tCONSTRUCTORS.forEach((constructor) => {\n\t\t\t\t\tconst regex = new RegExp(`\\\\b${constructor}\\\\b`, \"g\");\n\t\t\t\t\tlet match;\n\t\t\t\t\twhile ((match = regex.exec(line)) !== null) {\n\t\t\t\t\t\tbuilder.push(\n\t\t\t\t\t\t\tlineIndex,\n\t\t\t\t\t\t\tmatch.index,\n\t\t\t\t\t\t\tconstructor.length,\n\t\t\t\t\t\t\t1, // class token type\n\t\t\t\t\t\t\t1 << 6, // defaultLibrary modifier\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// Highlight function calls (identifier followed by parentheses)\n\t\t\t\tconst functionRegex = /\\b([a-zA-Z_][a-zA-Z0-9_]*)\\s*\\(/g;\n\t\t\t\tlet match;\n\t\t\t\twhile ((match = functionRegex.exec(line)) !== null) {\n\t\t\t\t\tconst funcName = match[1];\n\t\t\t\t\t// Skip if already categorized as API object or constructor\n\t\t\t\t\tif (\n\t\t\t\t\t\t!API_OBJECTS.includes(funcName) &&\n\t\t\t\t\t\t!CONSTRUCTORS.includes(funcName)\n\t\t\t\t\t) {\n\t\t\t\t\t\tbuilder.push(\n\t\t\t\t\t\t\tlineIndex,\n\t\t\t\t\t\t\tmatch.index,\n\t\t\t\t\t\t\tfuncName.length,\n\t\t\t\t\t\t\t2, // function token type\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Highlight numeric literals\n\t\t\t\tconst numberRegex = /\\b\\d+(\\.\\d+)?\\b/g;\n\t\t\t\twhile ((match = numberRegex.exec(line)) !== null) {\n\t\t\t\t\tbuilder.push(lineIndex, match.index, match[0].length, 7, 0);\n\t\t\t\t}\n\n\t\t\t\t// Highlight string literals (single, double, or template quotes)\n\t\t\t\tconst stringRegex = /\"([^\"\\\\]|\\\\.)*\"|'([^'\\\\]|\\\\.)*'|`([^`\\\\]|\\\\.)*`/g;\n\t\t\t\twhile ((match = stringRegex.exec(line)) !== null) {\n\t\t\t\t\tbuilder.push(lineIndex, match.index, match[0].length, 8, 0);\n\t\t\t\t}\n\n\t\t\t\t// Highlight single-line comments\n\t\t\t\tif (line.trim().startsWith(\"//\")) {\n\t\t\t\t\tbuilder.push(lineIndex, line.indexOf(\"//\"), line.length, 9, 0);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn builder.build();\n\t\t},\n\t);\n}\n"],"mappings":"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EACAC,MAAM;IACLH,MAAM;IACNC,aAAa;IACbG,YAAY;MACXC,KAAK;QACJL,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAK,QAAQ;QACPN,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAM,QAAQ;QACPP,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAO,MAAM;QACLR,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAQ,WAAW;QACVT,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAS,MAAM;QACLV,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAU,OAAO;QACNX,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAW,SAAS;QACRZ,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAY,MAAM;QACLb,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAa,OAAO;QACNd,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAc,QAAQ;QACPf,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAe,MAAM;QACLhB,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAgB,SAAS;QACRjB,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAiB,SAAS;QACRlB,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAkB,aAAa;QACZnB,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAmB,UAAU;QACTpB,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAoB,QAAQ;QACPrB,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAqB,OAAO;QACNtB,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAsB,MAAM;QACLvB,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAuB,IAAI;QACHxB,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAwB,MAAM;QACLzB,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAyB,KAAK;QACJ1B,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACA0B,OAAO;QACN3B,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACA2B,SAAS;QACR5B,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACA4B,QAAQ;QACP7B,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACA6B,MAAM;QACL9B,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACA8B,MAAM;QACL/B,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACA+B,QAAQ;QACPhC,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAgC,SAAS;QACRjC,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAiC,OAAO;QACNlC,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAkC,KAAK;QACJnC,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAmC,SAAS;QACRpC,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAoC,KAAK;QACJrC,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAqC,KAAK;QACJtC,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;IACD;EACD;EACAsC,MAAM;IACLvC,MAAM;IACNC,aAAa;IACbG,YAAY;MACXoC,KAAK;QACJxC,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAwC,MAAM;QACLzC,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAyC,OAAO;QACN1C,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACA0C,MAAM;QACL3C,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACA2C,OAAO;QACN5C,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAoC,KAAK;QACJrC,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAqC,KAAK;QACJtC,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACA4C,KAAK;QACJ7C,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACA6C,KAAK;QAAE9C,MAAM;QAAUE,WAAW;QAAeD,aAAa;MAAM;MACpE8C,KAAK;QACJ/C,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACA+C,OAAO;QACNhD,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAgD,KAAK;QACJjD,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAiD,KAAK;QACJlD,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAkD,KAAK;QACJnD,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAmD,MAAM;QACLpD,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAoD,MAAM;QACLrD,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAqD,MAAM;QACLtD,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAsD,OAAO;QACNvD,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAuD,QAAQ;QACPxD,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAwD,WAAW;QACVzD,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAyD,aAAa;QACZ1D,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACA0D,IAAI;QAAE3D,MAAM;QAAYC,aAAa;MAA2B;MAChE2D,GAAG;QAAE5D,MAAM;QAAYC,aAAa;MAA8B;MAClE4D,OAAO;QACN7D,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACA6D,MAAM;QACL9D,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACA8D,UAAU;QACT/D,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACA+D,YAAY;QACXhE,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAgE,cAAc;QACbjE,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAiE,UAAU;QACTlE,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAkE,UAAU;QACTnE,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAmE,MAAM;QACLpE,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAoE,KAAK;QACJrE,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;IACD;EACD;EACAqE,QAAQ;IACPtE,MAAM;IACNC,aAAa;IACbG,YAAY;MACXmE,OAAO;QACNvE,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACA8B,MAAM;QACL/B,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAuE,MAAM;QACLxE,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAwE,WAAW;QACVzE,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAyE,SAAS;QACR1E,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACA0E,SAAS;QACR3E,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACA2E,YAAY;QACX5E,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACA4E,YAAY;QACX7E,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACA6E,UAAU;QACT9E,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACA8E,UAAU;QACT/E,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACA+E,aAAa;QACZhF,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAgF,aAAa;QACZjF,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAiF,QAAQ;QACPlF,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAkF,YAAY;QACXnF,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAmF,cAAc;QACbpF,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAoF,WAAW;QACVrF,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAa,OAAO;QACNd,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAiB,SAAS;QACRlB,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAkB,aAAa;QACZnB,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAqF,QAAQ;QACPtF,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAsF,UAAU;QACTvF,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAuF,QAAQ;QACPxF,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAoB,QAAQ;QACPrB,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAwF,UAAU;QACTzF,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAyF,YAAY;QACX1F,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACA0F,QAAQ;QACP3F,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;IACD;EACD;EACA2F,MAAM;IACL5F,MAAM;IACNC,aAAa;IACbG,YAAY;MACXyF,QAAQ;QACP7F,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACA6F,QAAQ;QACP9F,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACA8F,QAAQ;QACP/F,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;IACD;EACD;EACA+F,QAAQ;IACPhG,MAAM;IACNC,aAAa;IACbC,WAAW;IACXE,YAAY;MACX6F,MAAM;QACLjG,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAiG,SAAS;QACRlG,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAkG,MAAM;QACLnG,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAmG,OAAO;QACNpG,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;IACD;EACD;EACAoG,YAAY;IACXrG,MAAM;IACNC,aAAa;IACbC,WAAW;IACXE,YAAY;MACXkG,SAAS;QACRtG,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAsG,SAAS;QACRvG,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAuG,OAAO;QACNxG,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAwG,SAAS;QACRzG,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAyG,YAAY;QACX1G,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;IACD;EACD;EACA0G,SAAS;IACR3G,MAAM;IACNC,aAAa;IACbG,YAAY;MACXwG,KAAK;QACJ5G,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACA4G,KAAK;QACJ7G,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACA6G,QAAQ;QACP9G,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACAuG,OAAO;QACNxG,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACA8G,KAAK;QACJ/G,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;MACA+G,MAAM;QACLhH,MAAM;QACNE,WAAW;QACXD,aAAa;MACd;IACD;EACD;AACD;;;AC5kBO,IAAMgH,YAAgC;EAC5CC,QAAQ;IACPC,MAAM;IACNC,aAAa;IACbC,YAAY;MACXC,OAAO;QACNH,MAAM;QACNC,aAAa;MACd;MACAG,QAAQ;QACPJ,MAAM;QACNC,aAAa;MACd;MACAI,YAAY;QACXL,MAAM;QACNC,aAAa;QACbK,WACC;MACF;MACAC,UAAU;QACTP,MAAM;QACNC,aAAa;QACbK,WACC;MACF;MACAE,UAAU;QACTR,MAAM;QACNC,aAAa;QACbK,WACC;MACF;MACAG,UAAU;QACTT,MAAM;QACNC,aAAa;QACbK,WACC;MACF;MACAI,aAAa;QACZV,MAAM;QACNC,aAAa;QACbK,WAAW;MACZ;MACAK,YAAY;QACXX,MAAM;QACNC,aAAa;QACbK,WACC;MACF;MACAM,YAAY;QACXZ,MAAM;QACNC,aAAa;QACbK,WACC;MACF;MACAO,UAAU;QACTb,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACAa,OAAO;QACNd,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACAc,UAAU;QACTf,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACAe,UAAU;QACThB,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACAgB,cAAc;QACbjB,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACAiB,aAAa;QACZlB,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACAkB,mBAAmB;QAClBnB,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACAmB,mBAAmB;QAClBpB,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACAoB,SAAS;QACRrB,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACAqB,UAAU;QACTtB,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACAsB,aAAa;QACZvB,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACAuB,gBAAgB;QACfxB,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACAwB,UAAU;QACTzB,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACAyB,aAAa;QACZ1B,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACA0B,eAAe;QACd3B,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACA2B,iBAAiB;QAChB5B,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACA4B,cAAc;QACb7B,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACA6B,eAAe;QACd9B,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACA8B,WAAW;QACV/B,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACA+B,eAAe;QACdhC,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACAgC,WAAW;QACVjC,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACAiC,WAAW;QACVlC,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACAkC,gBAAgB;QACfnC,MAAM;QACNM,WACC;QACDL,aAAa;MACd;MACAmC,eAAe;QACdpC,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACAoC,SAAS;QACRrC,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACAqC,iBAAiB;QAChBtC,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACAsC,WAAW;QACVvC,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACAuC,cAAc;QACbxC,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACAwC,aAAa;QACZzC,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACAyC,aAAa;QACZ1C,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACA0C,cAAc;QACb3C,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACA2C,aAAa;QACZ5C,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACA4C,eAAe;QACd7C,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACA6C,iBAAiB;QAChB9C,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACA8C,SAAS;QACR/C,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACA+C,SAAS;QACRhD,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACAgD,kBAAkB;QACjBjD,MAAM;QACNM,WAAW;QACXL,aAAa;MACd;MACAiD,KAAK;QACJlD,MAAM;QAC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B;QAChBR,MAAM;QACNI,WACC;QACDH,aAAa;MACd;MACAQ,aAAa;QACZT,MAAM;QACNI,WAAW;QACXH,aAAa;MACd;IACD;EACD;AACD;;;ACtCO,IAAMS,SAA6B;EACzCC,KAAK;IACJC,MAAM;IACNC,aAAa;IACbC,YAAY;MACXC,MAAM;QACLH,MAAM;QACNI,WACC;QACDH,aAAa;MACd;MACAI,OAAO;QACNL,MAAM;QACNI,WACC;QACDH,aACC;MACF;MACAK,MAAM;QACLN,MAAM;QACNI,WACC;QACDH,aAAa;MACd;MACAM,YAAY;QACXP,MAAM;QACNI,WAAW;QACXH,aAAa;MACd;MACAO,aAAa;QACZR,MAAM;QACNI,WAAW;QACXH,aAAa;MACd;MACAQ,YAAY;QACXT,MAAM;QACNI,WAAW;QACXH,aAAa;MACd;IACD;EACD;AACD;;;ACzCO,IAAMS,aAAiC;EAC7CC,SAAS;IACRC,MAAM;IACNC,aAAa;IACbC,YAAY;MACXC,OAAO;QACNH,MAAM;QACNI,WAAW;QACXH,aAAa;MACd;MACAI,OAAO;QACNL,MAAM;QACNI,WAAW;QACXH,aAAa;MACd;MACAK,OAAO;QACNN,MAAM;QACNI,WAAW;QACXH,aAAa;MACd;MACAM,QAAQ;QACPP,MAAM;QACNI,WACC;QACDH,aACC;MACF;MACAO,YAAY;QACXR,MAAM;QACNI,WAAW;QACXH,aAAa;MACd;MACAQ,aAAa;QACZT,MAAM;QACNI,WAAW;QACXH,aAAa;MACd;MACAS,SAAS;QACRV,MAAM;QACNI,WAAW;QACXH,aAAa;MACd;MACAU,aAAa;QACZX,MAAM;QACNI,WAAW;QACXH,aAAa;MACd;MACAW,UAAU;QACTZ,MAAM;QACNI,WAAW;QACXH,aAAa;MACd;MACAY,WAAW;QACVb,MAAM;QACNI,WACC;QACDH,aAAa;MACd;MACAa,WAAW;QACVd,MAAM;QACNI,WACC;QACDH,aAAa;MACd;MACAc,WAAW;QACVf,MAAM;QACNI,WAAW;QACXH,aAAa;MACd;MACAe,aAAa;QACZhB,MAAM;QACNI,WACC;QACDH,aAAa;MACd;IACD;EACD;AACD;;;A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","names":["import_node","import_vscode_languageserver_textdocument","DocumentRegions","regions","document","scanRegions","text","getText","lines","split","inJsonBlock","jsonBlockStart","i","length","line","jsonBlockMatch","match","jsonBlockEnd","startOffset","offsetAt","character","endOffset","push","languageId","start","end","startLine","startCharacter","endLine","endCharacter","jsonParseRegex","exec","index","indexOf","startPos","positionAt","endPos","getLanguageAtPosition","position","offset","region","getRegionsForLanguage","filter","r","getEmbeddedDocument","languageRegions","TextDocument","create","uri","version","result","lastOffset","sortedRegions","sort","a","b","repeat","substring","isInEmbeddedRegion","LanguageModelCache","cache","Map","maxEntries","get","document","key","uri","entry","version","value","create","set","size","firstKey","keys","next","undefined","delete","_document","Error","DocumentRegionsCache","DocumentRegions","LanguageModes","modes","documentRegions","registerMode","mode","getId","getModeAtPosition","position","regions","languageId","getLanguageAtPosition","getAllModes","Array","from","values","getMode","getJSONMode","jsonLanguageService","documentRegionsCache","getId","doComplete","document","position","documentRegions","get","embedded","getEmbeddedDocument","jsonDocument","parseJSONDocument","completions","doHover","doValidation","schemaValidation","findDocumentSymbols","findDocumentSymbols2","createJSONLanguageService","getLanguageService","schemaRequestService","_uri","workspaceContext","resolveRelativePath","relativePath","resource","base","substring","lastIndexOf","coreApi","print","type","description","signature","List","properties","map","filter","reduce","find","findIndex","some","every","reverse","sort","slice","concat","flat","flatMap","indexOf","lastIndexOf","includes","length","first","last","at","push","pop","shift","unshift","splice","fill","join","unique","shuffle","chunk","sum","average","min","max","Math","abs","sqrt","floor","ceil","round","pow","exp","log","log10","sin","cos","tan","asin","acos","atan","atan2","random","randomInt","randomFloat","PI","E","clamp","lerp","distance","distance3D","angleBetween","degToRad","radToDeg","sign","mod","String","split","trim","trimStart","trimEnd","replace","replaceAll","startsWith","endsWith","contains","toLowerCase","toUpperCase","charAt","charCodeAt","fromCharCode","substring","repeat","padStart","padEnd","parseInt","parseFloat","format","JSON","encode","decode","pretty","Random","next","nextInt","seed","clone","ObjectPool","acquire","release","clear","getSize","getMaxSize","storage","get","set","remove","has","keys","screenApi","screen","type","description","properties","width","height","drawSprite","signature","fillRect","drawRect","drawText","clearScreen","drawCircle","fillCircle","drawLine","clear","setColor","setAlpha","setPixelated","setBlending","setLinearGradient","setRadialGradient","setFont","loadFont","isFontReady","setTranslation","setScale","setRotation","setDrawAnchor","setDrawRotation","setDrawScale","fillRoundRect","fillRound","drawRoundRect","drawRound","drawImage","drawSpritePart","drawImagePart","drawMap","drawTextOutline","textWidth","setLineWidth","setLineDash","drawPolygon","drawPolyline","fillPolygon","drawQuadCurve","drawBezierCurve","drawArc","fillArc","setCursorVisible","tri","trib","ttri","audioApi","audio","type","description","properties","beep","signature","playSound","stopSound","setVolume","playMusic","stopMusic","inputApi","input","type","description","properties","keyboard","mouse","touch","gamepad","systemApi","system","type","description","properties","time","fps","deltaTime","cpu_load","update_rate","language","loading","inputs","pause","signature","exit","prompt","say","sceneApi","scene","type","description","signature","route","router","properties","push","replace","back","path","params","sceneName","getPath","getParams","getSceneName","scenes","goto","current","spritesApi","Sprite","type","description","signature","properties","play","stop","update","draw","Image","loadSprite","updateSprite","loadFont","isFontReady","clearFontCache","mapApi","Map","type","description","signature","properties","width","height","tileWidth","tileHeight","getTile","setTile","loadMap","saveMap","updateMap","timeApi","TimeMachine","type","description","signature","properties","record","play","stop","rewind","StatePlayer","StateRecorder","assetsApi","AssetManager","type","description","signature","properties","load","get","unload","paletteApi","Palette","type","description","signature","properties","get","set","size","playerApi","player","type","description","properties","fid","username","displayName","pfpUrl","getFid","signature","getUsername","getDisplayName","getPfpUrl","getContext","isInMiniApp","walletApi","wallet","type","description","properties","isConnected","signature","connect","getAddress","getChainId","sendTransaction","signMessage","evmApi","evm","type","description","properties","read","signature","write","call","getBalance","formatEther","parseEther","actionsApi","actions","type","description","properties","ready","signature","close","share","signIn","addMiniApp","openMiniApp","openUrl","viewProfile","viewCast","swapToken","sendToken","viewToken","composeCast","httpApi","http","type","description","properties","request","signature","get","post","put","delete","GLOBAL_API","coreApi","screenApi","audioApi","inputApi","systemApi","sceneApi","spritesApi","mapApi","timeApi","assetsApi","paletteApi","playerApi","walletApi","evmApi","actionsApi","httpApi","API_ACCESS_REGEX","documentStates","Map","getDocumentStates","updateDocumentState","textDocument","connection","text","getText","state","ast","scope","symbols","parser","Parser","uri","parse","convertParserAst","buildScope","collectSymbols","err","console","error","set","deleteDocumentState","delete","root","type","line","column","children","statements","program","stmt","push","convertNode","node","base","name","token","endLine","endColumn","identifier","sequence","child","body","expression","function_body","parent","visit","symbol","documentUri","range","buildRange","Range","create","Position","Math","max","length","getWordAtPosition","document","position","start","end","wordRegex","match","exec","index","character","import_node","import_parser","import_node","getWordAtPosition","document","position","line","getText","start","Position","create","end","Number","MAX_SAFE_INTEGER","regex","match","exec","index","length","character","detectCompletionContext","propertyMatch","type","object","openParenCount","closeParenCount","inFunctionCall","getClosestPropertySuggestion","target","candidates","bestMatch","candidate","score","levenshteinDistance","value","threshold","Math","max","floor","a","b","rows","cols","dp","Array","from","fill","i","j","cost","min","defaultSettings","diagnostics","enable","completion","signatureHelp","format","indentSize","globalSettings","documentSettings","Map","setGlobalSettings","settings","globalSettings","clearDocumentSettings","documentSettings","clear","getDocumentSettings","connection","hasConfigurationCapability","resource","globalSettings","cached","documentSettings","get","configuration","workspace","getConfiguration","scopeUri","section","sanitized","sanitizeSettings","set","settings","merged","rawIndent","format","indentSize","defaultSettings","normalizedIndent","Math","min","max","diagnostics","enable","completion","signatureHelp","validateTextDocument","textDocument","connection","hasConfigurationCapability","languageModes","documentRegionsCache","settings","getDocumentSettings","uri","diagnostics","enable","sendDiagnostics","text","getText","documentRegions","get","allModes","getAllModes","mode","doValidation","embeddedDoc","getEmbeddedDocument","getId","hasEmbeddedContent","trim","length","embeddedDiagnostics","push","parser","Parser","parse","error_info","err","diagnosticData","createDiagnostic","code","file","line","column","context","suggestions","related","message","undefined","data","error","lspDiagnostic","formatForLSP","e","diagnostic","severity","DiagnosticSeverity","Error","range","start","character","end","source","validateApiUsage","API_ACCESS_REGEX","lastIndex","seenPositions","Set","match","exec","matchIndex","index","has","add","fullPath","propertyName","rootObjectName","split","isNested","includes","knownRuntimeObjects","api","GLOBAL_API","propertyStart","startPos","positionAt","objectName","suggestion","properties","prevChar","getClosestPropertySuggestion","Object","keys","import_node","setupCompletionHandlers","connection","documents","languageModes","hasConfigurationCapability","onCompletion","params","uri","textDocument","document","get","settings","getDocumentSettings","completion","enable","position","mode","getModeAtPosition","doComplete","result","context","detectCompletionContext","type","object","getPropertyCompletions","documentStates","getDocumentStates","state","items","push","getSnippetCompletions","symbols","forEach","symbol","label","name","kind","CompletionItemKind","Function","Variable","detail","data","sortText","info","Object","entries","GLOBAL_API","Class","description","documentation","signature","keyword","Keyword","onCompletionResolve","item","objectName","api","properties","propName","propInfo","Method","Property","insertText","insertTextFormat","InsertTextFormat","Snippet","PlainText","setupHoverHandler","connection","documents","languageModes","onHover","params","document","get","textDocument","uri","mode","getModeAtPosition","position","doHover","result","error","console","message","documentStates","getDocumentStates","state","word","getWordAtPosition","symbol","findSymbolByName","contents","kind","value","name","type","globalInfo","GLOBAL_API","description","signature","symbols","find","sym","import_node","setupSignatureHelpHandler","connection","documents","hasConfigurationCapability","onSignatureHelp","params","document","get","textDocument","uri","settings","getDocumentSettings","signatureHelp","enable","line","getText","start","Position","create","position","end","character","functionMatch","match","functionName","parts","split","signature","description","length","objectName","methodName","api","GLOBAL_API","properties","paramMatch","paramsStr","parameters","filter","p","trim","map","param","label","commaCount","activeParameter","Math","min","signatures","SignatureInformation","activeSignature","import_node","setupSymbolHandlers","connection","onDefinition","params","documentStates","getDocumentStates","state","get","textDocument","uri","word","getWordAtPosition","position","symbol","findSymbolByName","Location","create","documentUri","range","onDocumentSymbol","symbols","map","name","kind","type","SymbolKind","Function","Variable","location","onWorkspaceSymbol","infos","values","forEach","push","onReferences","references","docState","text","getText","regex","RegExp","match","exec","start","positionAt","index","end","length","onRenameRequest","edits","newText","newName","changes","find","sym","import_node","setupFormattingHandler","connection","documents","hasConfigurationCapability","onDocumentFormatting","params","doc","get","textDocument","uri","settings","getDocumentSettings","format","enable","text","getText","lines","split","indentWidth","Math","max","indentSize","indentUnit","options","insertSpaces","repeat","indent","formatted","map","line","trimmed","trim","test","formattedLine","includes","fullRange","Range","create","Position","positionAt","length","TextEdit","replace","join","import_node","setupCodeActionsHandler","connection","documents","onCodeAction","params","actions","diagnostic","context","diagnostics","message","toLowerCase","errorCode","code","document","get","textDocument","uri","errorLine","range","end","line","insertLine","lineCount","nextLine","getText","start","character","Number","MAX_SAFE_INTEGER","trim","startsWith","push","title","kind","CodeActionKind","QuickFix","edit","changes","TextEdit","insert","Position","create","includes","replace","word","getWordAtPosition","selectedText","RefactorExtract","import_node","setupDefinitionHandler","connection","documents","onDefinition","params","document","get","textDocument","uri","documentStates","getDocumentStates","state","word","getWordAtPosition","position","symbol","symbols","name","Location","create","range","import_node","setupReferencesHandler","connection","documents","onReferences","params","document","get","textDocument","uri","documentStates","getDocumentStates","state","word","getWordAtPosition","position","locations","text","getText","lines","split","wordRegex","RegExp","forEach","line","lineIndex","match","exec","push","Location","create","Range","Position","index","length","import_node","RESERVED_KEYWORDS","API_RESERVED","setupRenameHandler","connection","documents","onPrepareRename","params","document","get","textDocument","uri","word","getWordAtPosition","position","includes","line","getText","start","Position","create","end","wordIndex","indexOf","range","Range","length","placeholder","onRenameRequest","newName","edits","text","lines","split","wordRegex","RegExp","forEach","lineIndex","match","exec","push","TextEdit","replace","index","changes","import_node","TOKEN_TYPES","TOKEN_MODIFIERS","API_OBJECTS","CONSTRUCTORS","setupSemanticTokensHandler","connection","documents","languages","semanticTokens","on","params","document","get","textDocument","uri","data","builder","SemanticTokensBuilder","text","getText","lines","split","forEach","line","lineIndex","api","regex","RegExp","match","exec","push","index","length","constructor","functionRegex","funcName","includes","numberRegex","stringRegex","trim","startsWith","indexOf","build","connection","createConnection","ProposedFeatures","all","documents","TextDocuments","TextDocument","documentRegionsCache","DocumentRegionsCache","languageModes","LanguageModes","jsonLanguageService","createJSONLanguageService","registerMode","getJSONMode","GLOBAL_API_REQUEST","onRequest","GLOBAL_API","hasConfigurationCapability","hasWorkspaceFolderCapability","onInitialize","params","capabilities","workspace","configuration","workspaceFolders","result","textDocumentSync","TextDocumentSyncKind","Incremental","completionProvider","resolveProvider","triggerCharacters","signatureHelpProvider","hoverProvider","definitionProvider","documentSymbolProvider","workspaceSymbolProvider","referencesProvider","documentFormattingProvider","renameProvider","prepareProvider","codeActionProvider","codeActionKinds","CodeActionKind","QuickFix","Refactor","semanticTokensProvider","legend","tokenTypes","TOKEN_TYPES","tokenModifiers","TOKEN_MODIFIERS","full","supported","onInitialized","client","register","DidChangeConfigurationNotification","type","undefined","onDidChangeWorkspaceFolders","_event","console","log","onDidChangeConfiguration","change","clearDocumentSettings","setGlobalSettings","sanitizeSettings","settings","lootiscript","doc","validateTextDocument","onDidChangeContent","updateDocumentState","document","onDidOpen","onDidClose","deleteDocumentState","uri","sendDiagnostics","diagnostics","onDidChangeWatchedFiles","_change","setupCompletionHandlers","setupHoverHandler","setupSignatureHelpHandler","setupSymbolHandlers","setupFormattingHandler","setupCodeActionsHandler","setupDefinitionHandler","setupReferencesHandler","setupRenameHandler","setupSemanticTokensHandler","listen"]}